<?php

namespace App\Http\Controllers\Report;

use Illuminate\Support\Facades\DB;
use App\Http\Controllers\Controller;



class Haematology extends Controller
{
   static public function haema($year_month)
    {
        $anti_tpha = DB::select("SELECT 
                (SELECT count(anti_tpha) FROM v_w_haematology_labs WHERE anti_tpha IS NOT NULL AND gender = 'Male' AND age < 1 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS anti_tpham1,
                (SELECT count(anti_tpha) FROM v_w_haematology_labs WHERE anti_tpha IS NOT NULL AND gender = 'Male' AND age BETWEEN 1 AND 4 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS anti_tpham2,
                (SELECT count(anti_tpha) FROM v_w_haematology_labs WHERE anti_tpha IS NOT NULL AND gender = 'Male' AND age BETWEEN 5 AND 9 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS anti_tpham3,
                (SELECT count(anti_tpha) FROM v_w_haematology_labs WHERE anti_tpha IS NOT NULL AND gender = 'Male' AND age BETWEEN 10 AND 14 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS anti_tpham4,
                (SELECT count(anti_tpha) FROM v_w_haematology_labs WHERE anti_tpha IS NOT NULL AND gender = 'Male' AND age BETWEEN 15 AND 17 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS anti_tpham5,
                (SELECT count(anti_tpha) FROM v_w_haematology_labs WHERE anti_tpha IS NOT NULL AND gender = 'Male' AND age BETWEEN 18 AND 19 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS anti_tpham6,
                (SELECT count(anti_tpha) FROM v_w_haematology_labs WHERE anti_tpha IS NOT NULL AND gender = 'Male' AND age BETWEEN 20 AND 34 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS anti_tpham7,
                (SELECT count(anti_tpha) FROM v_w_haematology_labs WHERE anti_tpha IS NOT NULL AND gender = 'Male' AND age BETWEEN 35 AND 49 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS anti_tpham8,
                (SELECT count(anti_tpha) FROM v_w_haematology_labs WHERE anti_tpha IS NOT NULL AND gender = 'Male' AND age BETWEEN 50 AND 59 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS anti_tpham9,
                (SELECT count(anti_tpha) FROM v_w_haematology_labs WHERE anti_tpha IS NOT NULL AND gender = 'Male' AND age BETWEEN 60 AND 69 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS anti_tpham10,
                (SELECT count(anti_tpha) FROM v_w_haematology_labs WHERE anti_tpha IS NOT NULL AND gender = 'Male' AND age > 69 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS anti_tpham11,
                (SELECT count(anti_tpha) FROM v_w_haematology_labs WHERE anti_tpha IS NOT NULL AND gender = 'Male' AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS anti_tpham12,
                (SELECT count(anti_tpha) FROM v_w_haematology_labs WHERE anti_tpha IS NOT NULL AND gender = 'Female' AND age < 1 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS anti_tphaf1,
                (SELECT count(anti_tpha) FROM v_w_haematology_labs WHERE anti_tpha IS NOT NULL AND gender = 'Female' AND age BETWEEN 1 AND 4 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS anti_tphaf2,
                (SELECT count(anti_tpha) FROM v_w_haematology_labs WHERE anti_tpha IS NOT NULL AND gender = 'Female' AND age BETWEEN 5 AND 9 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS anti_tphaf3,
                (SELECT count(anti_tpha) FROM v_w_haematology_labs WHERE anti_tpha IS NOT NULL AND gender = 'Female' AND age BETWEEN 10 AND 14 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS anti_tphaf4,
                (SELECT count(anti_tpha) FROM v_w_haematology_labs WHERE anti_tpha IS NOT NULL AND gender = 'Female' AND age BETWEEN 15 AND 17 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS anti_tphaf5,
                (SELECT count(anti_tpha) FROM v_w_haematology_labs WHERE anti_tpha IS NOT NULL AND gender = 'Female' AND age BETWEEN 18 AND 19 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS anti_tphaf6,
                (SELECT count(anti_tpha) FROM v_w_haematology_labs WHERE anti_tpha IS NOT NULL AND gender = 'Female' AND age BETWEEN 20 AND 34 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS anti_tphaf7,
                (SELECT count(anti_tpha) FROM v_w_haematology_labs WHERE anti_tpha IS NOT NULL AND gender = 'Female' AND age BETWEEN 35 AND 49 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS anti_tphaf8,
                (SELECT count(anti_tpha) FROM v_w_haematology_labs WHERE anti_tpha IS NOT NULL AND gender = 'Female' AND age BETWEEN 50 AND 59 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS anti_tphaf9,
                (SELECT count(anti_tpha) FROM v_w_haematology_labs WHERE anti_tpha IS NOT NULL AND gender = 'Female' AND age BETWEEN 60 AND 69 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS anti_tphaf10,
                (SELECT count(anti_tpha) FROM v_w_haematology_labs WHERE anti_tpha IS NOT NULL AND gender = 'Female' AND age > 69 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS anti_tphaf11,
                (SELECT count(anti_tpha) FROM v_w_haematology_labs WHERE anti_tpha IS NOT NULL AND gender = 'Female' AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS anti_tphaf12,
                (SELECT count(anti_tpha) FROM v_w_haematology_labs WHERE anti_tpha IS NOT NULL AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS anti_tpha
            ");
    
    $anti_tpha_pos = DB::select("SELECT 
                (SELECT count(anti_tpha) FROM v_w_haematology_labs WHERE anti_tpha = 'Positive' AND gender = 'Male' AND age < 1 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS anti_tpham1,
                (SELECT count(anti_tpha) FROM v_w_haematology_labs WHERE anti_tpha = 'Positive' AND gender = 'Male' AND age BETWEEN 1 AND 4 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS anti_tpham2,
                (SELECT count(anti_tpha) FROM v_w_haematology_labs WHERE anti_tpha = 'Positive' AND gender = 'Male' AND age BETWEEN 5 AND 9 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS anti_tpham3,
                (SELECT count(anti_tpha) FROM v_w_haematology_labs WHERE anti_tpha = 'Positive' AND gender = 'Male' AND age BETWEEN 10 AND 14 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS anti_tpham4,
                (SELECT count(anti_tpha) FROM v_w_haematology_labs WHERE anti_tpha = 'Positive' AND gender = 'Male' AND age BETWEEN 15 AND 17 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS anti_tpham5,
                (SELECT count(anti_tpha) FROM v_w_haematology_labs WHERE anti_tpha = 'Positive' AND gender = 'Male' AND age BETWEEN 18 AND 19 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS anti_tpham6,
                (SELECT count(anti_tpha) FROM v_w_haematology_labs WHERE anti_tpha = 'Positive' AND gender = 'Male' AND age BETWEEN 20 AND 34 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS anti_tpham7,
                (SELECT count(anti_tpha) FROM v_w_haematology_labs WHERE anti_tpha = 'Positive' AND gender = 'Male' AND age BETWEEN 35 AND 49 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS anti_tpham8,
                (SELECT count(anti_tpha) FROM v_w_haematology_labs WHERE anti_tpha = 'Positive' AND gender = 'Male' AND age BETWEEN 50 AND 59 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS anti_tpham9,
                (SELECT count(anti_tpha) FROM v_w_haematology_labs WHERE anti_tpha = 'Positive' AND gender = 'Male' AND age BETWEEN 60 AND 69 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS anti_tpham10,
                (SELECT count(anti_tpha) FROM v_w_haematology_labs WHERE anti_tpha = 'Positive' AND gender = 'Male' AND age > 69 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS anti_tpham11,
                (SELECT count(anti_tpha) FROM v_w_haematology_labs WHERE anti_tpha = 'Positive' AND gender = 'Male' AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS anti_tpham12,
                (SELECT count(anti_tpha) FROM v_w_haematology_labs WHERE anti_tpha = 'Positive' AND gender = 'Female' AND age < 1 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS anti_tphaf1,
                (SELECT count(anti_tpha) FROM v_w_haematology_labs WHERE anti_tpha = 'Positive' AND gender = 'Female' AND age BETWEEN 1 AND 4 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS anti_tphaf2,
                (SELECT count(anti_tpha) FROM v_w_haematology_labs WHERE anti_tpha = 'Positive' AND gender = 'Female' AND age BETWEEN 5 AND 9 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS anti_tphaf3,
                (SELECT count(anti_tpha) FROM v_w_haematology_labs WHERE anti_tpha = 'Positive' AND gender = 'Female' AND age BETWEEN 10 AND 14 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS anti_tphaf4,
                (SELECT count(anti_tpha) FROM v_w_haematology_labs WHERE anti_tpha = 'Positive' AND gender = 'Female' AND age BETWEEN 15 AND 17 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS anti_tphaf5,
                (SELECT count(anti_tpha) FROM v_w_haematology_labs WHERE anti_tpha = 'Positive' AND gender = 'Female' AND age BETWEEN 18 AND 19 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS anti_tphaf6,
                (SELECT count(anti_tpha) FROM v_w_haematology_labs WHERE anti_tpha = 'Positive' AND gender = 'Female' AND age BETWEEN 20 AND 34 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS anti_tphaf7,
                (SELECT count(anti_tpha) FROM v_w_haematology_labs WHERE anti_tpha = 'Positive' AND gender = 'Female' AND age BETWEEN 35 AND 49 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS anti_tphaf8,
                (SELECT count(anti_tpha) FROM v_w_haematology_labs WHERE anti_tpha = 'Positive' AND gender = 'Female' AND age BETWEEN 50 AND 59 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS anti_tphaf9,
                (SELECT count(anti_tpha) FROM v_w_haematology_labs WHERE anti_tpha = 'Positive' AND gender = 'Female' AND age BETWEEN 60 AND 69 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS anti_tphaf10,
                (SELECT count(anti_tpha) FROM v_w_haematology_labs WHERE anti_tpha = 'Positive' AND gender = 'Female' AND age > 69 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS anti_tphaf11,
                (SELECT count(anti_tpha) FROM v_w_haematology_labs WHERE anti_tpha = 'Positive' AND gender = 'Female' AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS anti_tphaf12,
                (SELECT count(anti_tpha) FROM v_w_haematology_labs WHERE anti_tpha = 'Positive' AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS anti_tpha    
            ");

        $hcv = DB::select("SELECT 
                (SELECT count(hcv) FROM v_w_haematology_labs WHERE hcv IS NOT NULL AND gender = 'Male' AND age < 1 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS hcvm1,
                (SELECT count(hcv) FROM v_w_haematology_labs WHERE hcv IS NOT NULL AND gender = 'Male' AND age BETWEEN 1 AND 4 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS hcvm2,
                (SELECT count(hcv) FROM v_w_haematology_labs WHERE hcv IS NOT NULL AND gender = 'Male' AND age BETWEEN 5 AND 9 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS hcvm3,
                (SELECT count(hcv) FROM v_w_haematology_labs WHERE hcv IS NOT NULL AND gender = 'Male' AND age BETWEEN 10 AND 14 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS hcvm4,
                (SELECT count(hcv) FROM v_w_haematology_labs WHERE hcv IS NOT NULL AND gender = 'Male' AND age BETWEEN 15 AND 17 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS hcvm5,
                (SELECT count(hcv) FROM v_w_haematology_labs WHERE hcv IS NOT NULL AND gender = 'Male' AND age BETWEEN 18 AND 19 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS hcvm6,
                (SELECT count(hcv) FROM v_w_haematology_labs WHERE hcv IS NOT NULL AND gender = 'Male' AND age BETWEEN 20 AND 34 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS hcvm7,
                (SELECT count(hcv) FROM v_w_haematology_labs WHERE hcv IS NOT NULL AND gender = 'Male' AND age BETWEEN 35 AND 49 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS hcvm8,
                (SELECT count(hcv) FROM v_w_haematology_labs WHERE hcv IS NOT NULL AND gender = 'Male' AND age BETWEEN 50 AND 59 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS hcvm9,
                (SELECT count(hcv) FROM v_w_haematology_labs WHERE hcv IS NOT NULL AND gender = 'Male' AND age BETWEEN 60 AND 69 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS hcvm10,
                (SELECT count(hcv) FROM v_w_haematology_labs WHERE hcv IS NOT NULL AND gender = 'Male' AND age > 69 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS hcvm11,
                (SELECT count(hcv) FROM v_w_haematology_labs WHERE hcv IS NOT NULL AND gender = 'Male' AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS hcvm12,
                (SELECT count(hcv) FROM v_w_haematology_labs WHERE hcv IS NOT NULL AND gender = 'Female' AND age < 1 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS hcvf1,
                (SELECT count(hcv) FROM v_w_haematology_labs WHERE hcv IS NOT NULL AND gender = 'Female' AND age BETWEEN 1 AND 4 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS hcvf2,
                (SELECT count(hcv) FROM v_w_haematology_labs WHERE hcv IS NOT NULL AND gender = 'Female' AND age BETWEEN 5 AND 9 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS hcvf3,
                (SELECT count(hcv) FROM v_w_haematology_labs WHERE hcv IS NOT NULL AND gender = 'Female' AND age BETWEEN 10 AND 14 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS hcvf4,
                (SELECT count(hcv) FROM v_w_haematology_labs WHERE hcv IS NOT NULL AND gender = 'Female' AND age BETWEEN 15 AND 17 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS hcvf5,
                (SELECT count(hcv) FROM v_w_haematology_labs WHERE hcv IS NOT NULL AND gender = 'Female' AND age BETWEEN 18 AND 19 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS hcvf6,
                (SELECT count(hcv) FROM v_w_haematology_labs WHERE hcv IS NOT NULL AND gender = 'Female' AND age BETWEEN 20 AND 34 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS hcvf7,
                (SELECT count(hcv) FROM v_w_haematology_labs WHERE hcv IS NOT NULL AND gender = 'Female' AND age BETWEEN 35 AND 49 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS hcvf8,
                (SELECT count(hcv) FROM v_w_haematology_labs WHERE hcv IS NOT NULL AND gender = 'Female' AND age BETWEEN 50 AND 59 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS hcvf9,
                (SELECT count(hcv) FROM v_w_haematology_labs WHERE hcv IS NOT NULL AND gender = 'Female' AND age BETWEEN 60 AND 69 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS hcvf10,
                (SELECT count(hcv) FROM v_w_haematology_labs WHERE hcv IS NOT NULL AND gender = 'Female' AND age > 69 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS hcvf11,
                (SELECT count(hcv) FROM v_w_haematology_labs WHERE hcv IS NOT NULL AND gender = 'Female' AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS hcvf12,
                (SELECT count(hcv) FROM v_w_haematology_labs WHERE hcv IS NOT NULL AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS hcv        
            ");

        $hcv_pos = DB::select("SELECT 
                (SELECT count(hcv) FROM v_w_haematology_labs WHERE hcv = 'Positive' AND gender = 'Male' AND age < 1 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS hcvm1,
                (SELECT count(hcv) FROM v_w_haematology_labs WHERE hcv = 'Positive' AND gender = 'Male' AND age BETWEEN 1 AND 4 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS hcvm2,
                (SELECT count(hcv) FROM v_w_haematology_labs WHERE hcv = 'Positive' AND gender = 'Male' AND age BETWEEN 5 AND 9 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS hcvm3,
                (SELECT count(hcv) FROM v_w_haematology_labs WHERE hcv = 'Positive' AND gender = 'Male' AND age BETWEEN 10 AND 14 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS hcvm4,
                (SELECT count(hcv) FROM v_w_haematology_labs WHERE hcv = 'Positive' AND gender = 'Male' AND age BETWEEN 15 AND 17 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS hcvm5,
                (SELECT count(hcv) FROM v_w_haematology_labs WHERE hcv = 'Positive' AND gender = 'Male' AND age BETWEEN 18 AND 19 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS hcvm6,
                (SELECT count(hcv) FROM v_w_haematology_labs WHERE hcv = 'Positive' AND gender = 'Male' AND age BETWEEN 20 AND 34 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS hcvm7,
                (SELECT count(hcv) FROM v_w_haematology_labs WHERE hcv = 'Positive' AND gender = 'Male' AND age BETWEEN 35 AND 49 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS hcvm8,
                (SELECT count(hcv) FROM v_w_haematology_labs WHERE hcv = 'Positive' AND gender = 'Male' AND age BETWEEN 50 AND 59 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS hcvm9,
                (SELECT count(hcv) FROM v_w_haematology_labs WHERE hcv = 'Positive' AND gender = 'Male' AND age BETWEEN 60 AND 69 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS hcvm10,
                (SELECT count(hcv) FROM v_w_haematology_labs WHERE hcv = 'Positive' AND gender = 'Male' AND age > 69 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS hcvm11,
                (SELECT count(hcv) FROM v_w_haematology_labs WHERE hcv = 'Positive' AND gender = 'Male' AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS hcvm12,
                (SELECT count(hcv) FROM v_w_haematology_labs WHERE hcv = 'Positive' AND gender = 'Female' AND age < 1 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS hcvf1,
                (SELECT count(hcv) FROM v_w_haematology_labs WHERE hcv = 'Positive' AND gender = 'Female' AND age BETWEEN 1 AND 4 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS hcvf2,
                (SELECT count(hcv) FROM v_w_haematology_labs WHERE hcv = 'Positive' AND gender = 'Female' AND age BETWEEN 5 AND 9 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS hcvf3,
                (SELECT count(hcv) FROM v_w_haematology_labs WHERE hcv = 'Positive' AND gender = 'Female' AND age BETWEEN 10 AND 14 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS hcvf4,
                (SELECT count(hcv) FROM v_w_haematology_labs WHERE hcv = 'Positive' AND gender = 'Female' AND age BETWEEN 15 AND 17 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS hcvf5,
                (SELECT count(hcv) FROM v_w_haematology_labs WHERE hcv = 'Positive' AND gender = 'Female' AND age BETWEEN 18 AND 19 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS hcvf6,
                (SELECT count(hcv) FROM v_w_haematology_labs WHERE hcv = 'Positive' AND gender = 'Female' AND age BETWEEN 20 AND 34 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS hcvf7,
                (SELECT count(hcv) FROM v_w_haematology_labs WHERE hcv = 'Positive' AND gender = 'Female' AND age BETWEEN 35 AND 49 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS hcvf8,
                (SELECT count(hcv) FROM v_w_haematology_labs WHERE hcv = 'Positive' AND gender = 'Female' AND age BETWEEN 50 AND 59 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS hcvf9,
                (SELECT count(hcv) FROM v_w_haematology_labs WHERE hcv = 'Positive' AND gender = 'Female' AND age BETWEEN 60 AND 69 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS hcvf10,
                (SELECT count(hcv) FROM v_w_haematology_labs WHERE hcv = 'Positive' AND gender = 'Female' AND age > 69 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS hcvf11,
                (SELECT count(hcv) FROM v_w_haematology_labs WHERE hcv = 'Positive' AND gender = 'Female' AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS hcvf12,
                (SELECT count(hcv) FROM v_w_haematology_labs WHERE hcv = 'Positive' AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS hcv
            ");

        $hbsag = DB::select("SELECT 
                (SELECT count(hbsag) FROM v_w_haematology_labs WHERE hbsag IS NOT NULL AND gender = 'Male' AND age < 1 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS hbsagm1,
                (SELECT count(hbsag) FROM v_w_haematology_labs WHERE hbsag IS NOT NULL AND gender = 'Male' AND age BETWEEN 1 AND 4 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS hbsagm2,
                (SELECT count(hbsag) FROM v_w_haematology_labs WHERE hbsag IS NOT NULL AND gender = 'Male' AND age BETWEEN 5 AND 9 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS hbsagm3,
                (SELECT count(hbsag) FROM v_w_haematology_labs WHERE hbsag IS NOT NULL AND gender = 'Male' AND age BETWEEN 10 AND 14 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS hbsagm4,
                (SELECT count(hbsag) FROM v_w_haematology_labs WHERE hbsag IS NOT NULL AND gender = 'Male' AND age BETWEEN 15 AND 17 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS hbsagm5,
                (SELECT count(hbsag) FROM v_w_haematology_labs WHERE hbsag IS NOT NULL AND gender = 'Male' AND age BETWEEN 18 AND 19 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS hbsagm6,
                (SELECT count(hbsag) FROM v_w_haematology_labs WHERE hbsag IS NOT NULL AND gender = 'Male' AND age BETWEEN 20 AND 34 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS hbsagm7,
                (SELECT count(hbsag) FROM v_w_haematology_labs WHERE hbsag IS NOT NULL AND gender = 'Male' AND age BETWEEN 35 AND 49 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS hbsagm8,
                (SELECT count(hbsag) FROM v_w_haematology_labs WHERE hbsag IS NOT NULL AND gender = 'Male' AND age BETWEEN 50 AND 59 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS hbsagm9,
                (SELECT count(hbsag) FROM v_w_haematology_labs WHERE hbsag IS NOT NULL AND gender = 'Male' AND age BETWEEN 60 AND 69 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS hbsagm10,
                (SELECT count(hbsag) FROM v_w_haematology_labs WHERE hbsag IS NOT NULL AND gender = 'Male' AND age > 69 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS hbsagm11,
                (SELECT count(hbsag) FROM v_w_haematology_labs WHERE hbsag IS NOT NULL AND gender = 'Male' AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS hbsagm12,
                (SELECT count(hbsag) FROM v_w_haematology_labs WHERE hbsag IS NOT NULL AND gender = 'Female' AND age < 1 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS hbsagf1,
                (SELECT count(hbsag) FROM v_w_haematology_labs WHERE hbsag IS NOT NULL AND gender = 'Female' AND age BETWEEN 1 AND 4 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS hbsagf2,
                (SELECT count(hbsag) FROM v_w_haematology_labs WHERE hbsag IS NOT NULL AND gender = 'Female' AND age BETWEEN 5 AND 9 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS hbsagf3,
                (SELECT count(hbsag) FROM v_w_haematology_labs WHERE hbsag IS NOT NULL AND gender = 'Female' AND age BETWEEN 10 AND 14 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS hbsagf4,
                (SELECT count(hbsag) FROM v_w_haematology_labs WHERE hbsag IS NOT NULL AND gender = 'Female' AND age BETWEEN 15 AND 17 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS hbsagf5,
                (SELECT count(hbsag) FROM v_w_haematology_labs WHERE hbsag IS NOT NULL AND gender = 'Female' AND age BETWEEN 18 AND 19 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS hbsagf6,
                (SELECT count(hbsag) FROM v_w_haematology_labs WHERE hbsag IS NOT NULL AND gender = 'Female' AND age BETWEEN 20 AND 34 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS hbsagf7,
                (SELECT count(hbsag) FROM v_w_haematology_labs WHERE hbsag IS NOT NULL AND gender = 'Female' AND age BETWEEN 35 AND 49 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS hbsagf8,
                (SELECT count(hbsag) FROM v_w_haematology_labs WHERE hbsag IS NOT NULL AND gender = 'Female' AND age BETWEEN 50 AND 59 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS hbsagf9,
                (SELECT count(hbsag) FROM v_w_haematology_labs WHERE hbsag IS NOT NULL AND gender = 'Female' AND age BETWEEN 60 AND 69 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS hbsagf10,
                (SELECT count(hbsag) FROM v_w_haematology_labs WHERE hbsag IS NOT NULL AND gender = 'Female' AND age > 69 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS hbsagf11,
                (SELECT count(hbsag) FROM v_w_haematology_labs WHERE hbsag IS NOT NULL AND gender = 'Female' AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS hbsagf12,
                (SELECT count(hbsag) FROM v_w_haematology_labs WHERE hbsag IS NOT NULL AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS hbsag
            ");

        $hbsag_pos = DB::select("SELECT 
                (SELECT count(hbsag) FROM v_w_haematology_labs WHERE hbsag = 'Positive' AND gender = 'Male' AND age < 1 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS hbsagm1,
                (SELECT count(hbsag) FROM v_w_haematology_labs WHERE hbsag = 'Positive' AND gender = 'Male' AND age BETWEEN 1 AND 4 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS hbsagm2,
                (SELECT count(hbsag) FROM v_w_haematology_labs WHERE hbsag = 'Positive' AND gender = 'Male' AND age BETWEEN 5 AND 9 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS hbsagm3,
                (SELECT count(hbsag) FROM v_w_haematology_labs WHERE hbsag = 'Positive' AND gender = 'Male' AND age BETWEEN 10 AND 14 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS hbsagm4,
                (SELECT count(hbsag) FROM v_w_haematology_labs WHERE hbsag = 'Positive' AND gender = 'Male' AND age BETWEEN 15 AND 17 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS hbsagm5,
                (SELECT count(hbsag) FROM v_w_haematology_labs WHERE hbsag = 'Positive' AND gender = 'Male' AND age BETWEEN 18 AND 19 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS hbsagm6,
                (SELECT count(hbsag) FROM v_w_haematology_labs WHERE hbsag = 'Positive' AND gender = 'Male' AND age BETWEEN 20 AND 34 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS hbsagm7,
                (SELECT count(hbsag) FROM v_w_haematology_labs WHERE hbsag = 'Positive' AND gender = 'Male' AND age BETWEEN 35 AND 49 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS hbsagm8,
                (SELECT count(hbsag) FROM v_w_haematology_labs WHERE hbsag = 'Positive' AND gender = 'Male' AND age BETWEEN 50 AND 59 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS hbsagm9,
                (SELECT count(hbsag) FROM v_w_haematology_labs WHERE hbsag = 'Positive' AND gender = 'Male' AND age BETWEEN 60 AND 69 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS hbsagm10,
                (SELECT count(hbsag) FROM v_w_haematology_labs WHERE hbsag = 'Positive' AND gender = 'Male' AND age > 69 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS hbsagm11,
                (SELECT count(hbsag) FROM v_w_haematology_labs WHERE hbsag = 'Positive' AND gender = 'Male' AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS hbsagm12,
                (SELECT count(hbsag) FROM v_w_haematology_labs WHERE hbsag = 'Positive' AND gender = 'Female' AND age < 1 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS hbsagf1,
                (SELECT count(hbsag) FROM v_w_haematology_labs WHERE hbsag = 'Positive' AND gender = 'Female' AND age BETWEEN 1 AND 4 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS hbsagf2,
                (SELECT count(hbsag) FROM v_w_haematology_labs WHERE hbsag = 'Positive' AND gender = 'Female' AND age BETWEEN 5 AND 9 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS hbsagf3,
                (SELECT count(hbsag) FROM v_w_haematology_labs WHERE hbsag = 'Positive' AND gender = 'Female' AND age BETWEEN 10 AND 14 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS hbsagf4,
                (SELECT count(hbsag) FROM v_w_haematology_labs WHERE hbsag = 'Positive' AND gender = 'Female' AND age BETWEEN 15 AND 17 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS hbsagf5,
                (SELECT count(hbsag) FROM v_w_haematology_labs WHERE hbsag = 'Positive' AND gender = 'Female' AND age BETWEEN 18 AND 19 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS hbsagf6,
                (SELECT count(hbsag) FROM v_w_haematology_labs WHERE hbsag = 'Positive' AND gender = 'Female' AND age BETWEEN 20 AND 34 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS hbsagf7,
                (SELECT count(hbsag) FROM v_w_haematology_labs WHERE hbsag = 'Positive' AND gender = 'Female' AND age BETWEEN 35 AND 49 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS hbsagf8,
                (SELECT count(hbsag) FROM v_w_haematology_labs WHERE hbsag = 'Positive' AND gender = 'Female' AND age BETWEEN 50 AND 59 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS hbsagf9,
                (SELECT count(hbsag) FROM v_w_haematology_labs WHERE hbsag = 'Positive' AND gender = 'Female' AND age BETWEEN 60 AND 69 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS hbsagf10,
                (SELECT count(hbsag) FROM v_w_haematology_labs WHERE hbsag = 'Positive' AND gender = 'Female' AND age > 69 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS hbsagf11,
                (SELECT count(hbsag) FROM v_w_haematology_labs WHERE hbsag = 'Positive' AND gender = 'Female' AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS hbsagf12,
                (SELECT count(hbsag) FROM v_w_haematology_labs WHERE hbsag = 'Positive' AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS hbsag
            ");

        $fbs = DB::select("SELECT 
                (SELECT count(fbs) FROM v_w_haematology_labs WHERE fbs IS NOT NULL AND gender = 'Male' AND age < 1 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS fbsm1,
                (SELECT count(fbs) FROM v_w_haematology_labs WHERE fbs IS NOT NULL AND gender = 'Male' AND age BETWEEN 1 AND 4 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS fbsm2,
                (SELECT count(fbs) FROM v_w_haematology_labs WHERE fbs IS NOT NULL AND gender = 'Male' AND age BETWEEN 5 AND 9 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS fbsm3,
                (SELECT count(fbs) FROM v_w_haematology_labs WHERE fbs IS NOT NULL AND gender = 'Male' AND age BETWEEN 10 AND 14 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS fbsm4,
                (SELECT count(fbs) FROM v_w_haematology_labs WHERE fbs IS NOT NULL AND gender = 'Male' AND age BETWEEN 15 AND 17 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS fbsm5,
                (SELECT count(fbs) FROM v_w_haematology_labs WHERE fbs IS NOT NULL AND gender = 'Male' AND age BETWEEN 18 AND 19 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS fbsm6,
                (SELECT count(fbs) FROM v_w_haematology_labs WHERE fbs IS NOT NULL AND gender = 'Male' AND age BETWEEN 20 AND 34 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS fbsm7,
                (SELECT count(fbs) FROM v_w_haematology_labs WHERE fbs IS NOT NULL AND gender = 'Male' AND age BETWEEN 35 AND 49 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS fbsm8,
                (SELECT count(fbs) FROM v_w_haematology_labs WHERE fbs IS NOT NULL AND gender = 'Male' AND age BETWEEN 50 AND 59 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS fbsm9,
                (SELECT count(fbs) FROM v_w_haematology_labs WHERE fbs IS NOT NULL AND gender = 'Male' AND age BETWEEN 60 AND 69 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS fbsm10,
                (SELECT count(fbs) FROM v_w_haematology_labs WHERE fbs IS NOT NULL AND gender = 'Male' AND age > 69 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS fbsm11,
                (SELECT count(fbs) FROM v_w_haematology_labs WHERE fbs IS NOT NULL AND gender = 'Male' AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS fbsm12,
                (SELECT count(fbs) FROM v_w_haematology_labs WHERE fbs IS NOT NULL AND gender = 'Female' AND age < 1 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS fbsf1,
                (SELECT count(fbs) FROM v_w_haematology_labs WHERE fbs IS NOT NULL AND gender = 'Female' AND age BETWEEN 1 AND 4 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS fbsf2,
                (SELECT count(fbs) FROM v_w_haematology_labs WHERE fbs IS NOT NULL AND gender = 'Female' AND age BETWEEN 5 AND 9 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS fbsf3,
                (SELECT count(fbs) FROM v_w_haematology_labs WHERE fbs IS NOT NULL AND gender = 'Female' AND age BETWEEN 10 AND 14 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS fbsf4,
                (SELECT count(fbs) FROM v_w_haematology_labs WHERE fbs IS NOT NULL AND gender = 'Female' AND age BETWEEN 15 AND 17 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS fbsf5,
                (SELECT count(fbs) FROM v_w_haematology_labs WHERE fbs IS NOT NULL AND gender = 'Female' AND age BETWEEN 18 AND 19 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS fbsf6,
                (SELECT count(fbs) FROM v_w_haematology_labs WHERE fbs IS NOT NULL AND gender = 'Female' AND age BETWEEN 20 AND 34 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS fbsf7,
                (SELECT count(fbs) FROM v_w_haematology_labs WHERE fbs IS NOT NULL AND gender = 'Female' AND age BETWEEN 35 AND 49 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS fbsf8,
                (SELECT count(fbs) FROM v_w_haematology_labs WHERE fbs IS NOT NULL AND gender = 'Female' AND age BETWEEN 50 AND 59 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS fbsf9,
                (SELECT count(fbs) FROM v_w_haematology_labs WHERE fbs IS NOT NULL AND gender = 'Female' AND age BETWEEN 60 AND 69 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS fbsf10,
                (SELECT count(fbs) FROM v_w_haematology_labs WHERE fbs IS NOT NULL AND gender = 'Female' AND age > 69 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS fbsf11,
                (SELECT count(fbs) FROM v_w_haematology_labs WHERE fbs IS NOT NULL AND gender = 'Female' AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS fbsf12,
                (SELECT count(fbs) FROM v_w_haematology_labs WHERE fbs IS NOT NULL AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS fbs
            ");

        $blood = DB::select("SELECT 
                (SELECT count(blood) FROM v_w_haematology_labs WHERE blood IS NOT NULL AND gender = 'Male' AND age < 1 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bloodm1,
                (SELECT count(blood) FROM v_w_haematology_labs WHERE blood IS NOT NULL AND gender = 'Male' AND age BETWEEN 1 AND 4 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bloodm2,
                (SELECT count(blood) FROM v_w_haematology_labs WHERE blood IS NOT NULL AND gender = 'Male' AND age BETWEEN 5 AND 9 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bloodm3,
                (SELECT count(blood) FROM v_w_haematology_labs WHERE blood IS NOT NULL AND gender = 'Male' AND age BETWEEN 10 AND 14 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bloodm4,
                (SELECT count(blood) FROM v_w_haematology_labs WHERE blood IS NOT NULL AND gender = 'Male' AND age BETWEEN 15 AND 17 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bloodm5,
                (SELECT count(blood) FROM v_w_haematology_labs WHERE blood IS NOT NULL AND gender = 'Male' AND age BETWEEN 18 AND 19 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bloodm6,
                (SELECT count(blood) FROM v_w_haematology_labs WHERE blood IS NOT NULL AND gender = 'Male' AND age BETWEEN 20 AND 34 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bloodm7,
                (SELECT count(blood) FROM v_w_haematology_labs WHERE blood IS NOT NULL AND gender = 'Male' AND age BETWEEN 35 AND 49 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bloodm8,
                (SELECT count(blood) FROM v_w_haematology_labs WHERE blood IS NOT NULL AND gender = 'Male' AND age BETWEEN 50 AND 59 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bloodm9,
                (SELECT count(blood) FROM v_w_haematology_labs WHERE blood IS NOT NULL AND gender = 'Male' AND age BETWEEN 60 AND 69 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bloodm10,
                (SELECT count(blood) FROM v_w_haematology_labs WHERE blood IS NOT NULL AND gender = 'Male' AND age > 69 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bloodm11,
                (SELECT count(blood) FROM v_w_haematology_labs WHERE blood IS NOT NULL AND gender = 'Male' AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bloodm12,
                (SELECT count(blood) FROM v_w_haematology_labs WHERE blood IS NOT NULL AND gender = 'Female' AND age < 1 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bloodf1,
                (SELECT count(blood) FROM v_w_haematology_labs WHERE blood IS NOT NULL AND gender = 'Female' AND age BETWEEN 1 AND 4 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bloodf2,
                (SELECT count(blood) FROM v_w_haematology_labs WHERE blood IS NOT NULL AND gender = 'Female' AND age BETWEEN 5 AND 9 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bloodf3,
                (SELECT count(blood) FROM v_w_haematology_labs WHERE blood IS NOT NULL AND gender = 'Female' AND age BETWEEN 10 AND 14 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bloodf4,
                (SELECT count(blood) FROM v_w_haematology_labs WHERE blood IS NOT NULL AND gender = 'Female' AND age BETWEEN 15 AND 17 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bloodf5,
                (SELECT count(blood) FROM v_w_haematology_labs WHERE blood IS NOT NULL AND gender = 'Female' AND age BETWEEN 18 AND 19 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bloodf6,
                (SELECT count(blood) FROM v_w_haematology_labs WHERE blood IS NOT NULL AND gender = 'Female' AND age BETWEEN 20 AND 34 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bloodf7,
                (SELECT count(blood) FROM v_w_haematology_labs WHERE blood IS NOT NULL AND gender = 'Female' AND age BETWEEN 35 AND 49 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bloodf8,
                (SELECT count(blood) FROM v_w_haematology_labs WHERE blood IS NOT NULL AND gender = 'Female' AND age BETWEEN 50 AND 59 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bloodf9,
                (SELECT count(blood) FROM v_w_haematology_labs WHERE blood IS NOT NULL AND gender = 'Female' AND age BETWEEN 60 AND 69 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bloodf10,
                (SELECT count(blood) FROM v_w_haematology_labs WHERE blood IS NOT NULL AND gender = 'Female' AND age > 69 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bloodf11,
                (SELECT count(blood) FROM v_w_haematology_labs WHERE blood IS NOT NULL AND gender = 'Female' AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bloodf12,
                (SELECT count(blood) FROM v_w_haematology_labs WHERE blood IS NOT NULL AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS blood        
            ");

        $g6pd_nor = DB::select("SELECT 
                (SELECT count(g6pd) FROM v_w_haematology_labs WHERE g6pd = 'Normal Enzyme Activity' AND gender = 'Male' AND age < 1 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS g6pdm1,
                (SELECT count(g6pd) FROM v_w_haematology_labs WHERE g6pd = 'Normal Enzyme Activity' AND gender = 'Male' AND age BETWEEN 1 AND 4 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS g6pdm2,
                (SELECT count(g6pd) FROM v_w_haematology_labs WHERE g6pd = 'Normal Enzyme Activity' AND gender = 'Male' AND age BETWEEN 5 AND 9 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS g6pdm3,
                (SELECT count(g6pd) FROM v_w_haematology_labs WHERE g6pd = 'Normal Enzyme Activity' AND gender = 'Male' AND age BETWEEN 10 AND 14 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS g6pdm4,
                (SELECT count(g6pd) FROM v_w_haematology_labs WHERE g6pd = 'Normal Enzyme Activity' AND gender = 'Male' AND age BETWEEN 15 AND 17 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS g6pdm5,
                (SELECT count(g6pd) FROM v_w_haematology_labs WHERE g6pd = 'Normal Enzyme Activity' AND gender = 'Male' AND age BETWEEN 18 AND 19 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS g6pdm6,
                (SELECT count(g6pd) FROM v_w_haematology_labs WHERE g6pd = 'Normal Enzyme Activity' AND gender = 'Male' AND age BETWEEN 20 AND 34 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS g6pdm7,
                (SELECT count(g6pd) FROM v_w_haematology_labs WHERE g6pd = 'Normal Enzyme Activity' AND gender = 'Male' AND age BETWEEN 35 AND 49 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS g6pdm8,
                (SELECT count(g6pd) FROM v_w_haematology_labs WHERE g6pd = 'Normal Enzyme Activity' AND gender = 'Male' AND age BETWEEN 50 AND 59 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS g6pdm9,
                (SELECT count(g6pd) FROM v_w_haematology_labs WHERE g6pd = 'Normal Enzyme Activity' AND gender = 'Male' AND age BETWEEN 60 AND 69 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS g6pdm10,
                (SELECT count(g6pd) FROM v_w_haematology_labs WHERE g6pd = 'Normal Enzyme Activity' AND gender = 'Male' AND age > 69 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS g6pdm11,
                (SELECT count(g6pd) FROM v_w_haematology_labs WHERE g6pd = 'Normal Enzyme Activity' AND gender = 'Male' AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS g6pdm12,
                (SELECT count(g6pd) FROM v_w_haematology_labs WHERE g6pd = 'Normal Enzyme Activity' AND gender = 'Female' AND age < 1 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS g6pdf1,
                (SELECT count(g6pd) FROM v_w_haematology_labs WHERE g6pd = 'Normal Enzyme Activity' AND gender = 'Female' AND age BETWEEN 1 AND 4 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS g6pdf2,
                (SELECT count(g6pd) FROM v_w_haematology_labs WHERE g6pd = 'Normal Enzyme Activity' AND gender = 'Female' AND age BETWEEN 5 AND 9 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS g6pdf3,
                (SELECT count(g6pd) FROM v_w_haematology_labs WHERE g6pd = 'Normal Enzyme Activity' AND gender = 'Female' AND age BETWEEN 10 AND 14 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS g6pdf4,
                (SELECT count(g6pd) FROM v_w_haematology_labs WHERE g6pd = 'Normal Enzyme Activity' AND gender = 'Female' AND age BETWEEN 15 AND 17 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS g6pdf5,
                (SELECT count(g6pd) FROM v_w_haematology_labs WHERE g6pd = 'Normal Enzyme Activity' AND gender = 'Female' AND age BETWEEN 18 AND 19 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS g6pdf6,
                (SELECT count(g6pd) FROM v_w_haematology_labs WHERE g6pd = 'Normal Enzyme Activity' AND gender = 'Female' AND age BETWEEN 20 AND 34 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS g6pdf7,
                (SELECT count(g6pd) FROM v_w_haematology_labs WHERE g6pd = 'Normal Enzyme Activity' AND gender = 'Female' AND age BETWEEN 35 AND 49 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS g6pdf8,
                (SELECT count(g6pd) FROM v_w_haematology_labs WHERE g6pd = 'Normal Enzyme Activity' AND gender = 'Female' AND age BETWEEN 50 AND 59 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS g6pdf9,
                (SELECT count(g6pd) FROM v_w_haematology_labs WHERE g6pd = 'Normal Enzyme Activity' AND gender = 'Female' AND age BETWEEN 60 AND 69 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS g6pdf10,
                (SELECT count(g6pd) FROM v_w_haematology_labs WHERE g6pd = 'Normal Enzyme Activity' AND gender = 'Female' AND age > 69 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS g6pdf11,
                (SELECT count(g6pd) FROM v_w_haematology_labs WHERE g6pd = 'Normal Enzyme Activity' AND gender = 'Female' AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS g6pdf12,
                (SELECT count(g6pd) FROM v_w_haematology_labs WHERE g6pd = 'Normal Enzyme Activity' AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS g6pd
            ");

        $g6pd_par = DB::select("SELECT 
                (SELECT count(g6pd) FROM v_w_haematology_labs WHERE g6pd = 'Partial Defect' AND gender = 'Male' AND age < 1 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS g6pdm1,
                (SELECT count(g6pd) FROM v_w_haematology_labs WHERE g6pd = 'Partial Defect' AND gender = 'Male' AND age BETWEEN 1 AND 4 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS g6pdm2,
                (SELECT count(g6pd) FROM v_w_haematology_labs WHERE g6pd = 'Partial Defect' AND gender = 'Male' AND age BETWEEN 5 AND 9 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS g6pdm3,
                (SELECT count(g6pd) FROM v_w_haematology_labs WHERE g6pd = 'Partial Defect' AND gender = 'Male' AND age BETWEEN 10 AND 14 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS g6pdm4,
                (SELECT count(g6pd) FROM v_w_haematology_labs WHERE g6pd = 'Partial Defect' AND gender = 'Male' AND age BETWEEN 15 AND 17 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS g6pdm5,
                (SELECT count(g6pd) FROM v_w_haematology_labs WHERE g6pd = 'Partial Defect' AND gender = 'Male' AND age BETWEEN 18 AND 19 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS g6pdm6,
                (SELECT count(g6pd) FROM v_w_haematology_labs WHERE g6pd = 'Partial Defect' AND gender = 'Male' AND age BETWEEN 20 AND 34 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS g6pdm7,
                (SELECT count(g6pd) FROM v_w_haematology_labs WHERE g6pd = 'Partial Defect' AND gender = 'Male' AND age BETWEEN 35 AND 49 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS g6pdm8,
                (SELECT count(g6pd) FROM v_w_haematology_labs WHERE g6pd = 'Partial Defect' AND gender = 'Male' AND age BETWEEN 50 AND 59 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS g6pdm9,
                (SELECT count(g6pd) FROM v_w_haematology_labs WHERE g6pd = 'Partial Defect' AND gender = 'Male' AND age BETWEEN 60 AND 69 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS g6pdm10,
                (SELECT count(g6pd) FROM v_w_haematology_labs WHERE g6pd = 'Partial Defect' AND gender = 'Male' AND age > 69 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS g6pdm11,
                (SELECT count(g6pd) FROM v_w_haematology_labs WHERE g6pd = 'Partial Defect' AND gender = 'Male' AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS g6pdm12,
                (SELECT count(g6pd) FROM v_w_haematology_labs WHERE g6pd = 'Partial Defect' AND gender = 'Female' AND age < 1 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS g6pdf1,
                (SELECT count(g6pd) FROM v_w_haematology_labs WHERE g6pd = 'Partial Defect' AND gender = 'Female' AND age BETWEEN 1 AND 4 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS g6pdf2,
                (SELECT count(g6pd) FROM v_w_haematology_labs WHERE g6pd = 'Partial Defect' AND gender = 'Female' AND age BETWEEN 5 AND 9 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS g6pdf3,
                (SELECT count(g6pd) FROM v_w_haematology_labs WHERE g6pd = 'Partial Defect' AND gender = 'Female' AND age BETWEEN 10 AND 14 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS g6pdf4,
                (SELECT count(g6pd) FROM v_w_haematology_labs WHERE g6pd = 'Partial Defect' AND gender = 'Female' AND age BETWEEN 15 AND 17 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS g6pdf5,
                (SELECT count(g6pd) FROM v_w_haematology_labs WHERE g6pd = 'Partial Defect' AND gender = 'Female' AND age BETWEEN 18 AND 19 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS g6pdf6,
                (SELECT count(g6pd) FROM v_w_haematology_labs WHERE g6pd = 'Partial Defect' AND gender = 'Female' AND age BETWEEN 20 AND 34 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS g6pdf7,
                (SELECT count(g6pd) FROM v_w_haematology_labs WHERE g6pd = 'Partial Defect' AND gender = 'Female' AND age BETWEEN 35 AND 49 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS g6pdf8,
                (SELECT count(g6pd) FROM v_w_haematology_labs WHERE g6pd = 'Partial Defect' AND gender = 'Female' AND age BETWEEN 50 AND 59 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS g6pdf9,
                (SELECT count(g6pd) FROM v_w_haematology_labs WHERE g6pd = 'Partial Defect' AND gender = 'Female' AND age BETWEEN 60 AND 69 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS g6pdf10,
                (SELECT count(g6pd) FROM v_w_haematology_labs WHERE g6pd = 'Partial Defect' AND gender = 'Female' AND age > 69 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS g6pdf11,
                (SELECT count(g6pd) FROM v_w_haematology_labs WHERE g6pd = 'Partial Defect' AND gender = 'Female' AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS g6pdf12,
                (SELECT count(g6pd) FROM v_w_haematology_labs WHERE g6pd = 'Partial Defect' AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS g6pd
            ");

        $g6pd_ful = DB::select("SELECT 
                (SELECT count(g6pd) FROM v_w_haematology_labs WHERE g6pd = 'Full Defect' AND gender = 'Male' AND age < 1 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS g6pdm1,
                (SELECT count(g6pd) FROM v_w_haematology_labs WHERE g6pd = 'Full Defect' AND gender = 'Male' AND age BETWEEN 1 AND 4 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS g6pdm2,
                (SELECT count(g6pd) FROM v_w_haematology_labs WHERE g6pd = 'Full Defect' AND gender = 'Male' AND age BETWEEN 5 AND 9 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS g6pdm3,
                (SELECT count(g6pd) FROM v_w_haematology_labs WHERE g6pd = 'Full Defect' AND gender = 'Male' AND age BETWEEN 10 AND 14 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS g6pdm4,
                (SELECT count(g6pd) FROM v_w_haematology_labs WHERE g6pd = 'Full Defect' AND gender = 'Male' AND age BETWEEN 15 AND 17 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS g6pdm5,
                (SELECT count(g6pd) FROM v_w_haematology_labs WHERE g6pd = 'Full Defect' AND gender = 'Male' AND age BETWEEN 18 AND 19 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS g6pdm6,
                (SELECT count(g6pd) FROM v_w_haematology_labs WHERE g6pd = 'Full Defect' AND gender = 'Male' AND age BETWEEN 20 AND 34 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS g6pdm7,
                (SELECT count(g6pd) FROM v_w_haematology_labs WHERE g6pd = 'Full Defect' AND gender = 'Male' AND age BETWEEN 35 AND 49 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS g6pdm8,
                (SELECT count(g6pd) FROM v_w_haematology_labs WHERE g6pd = 'Full Defect' AND gender = 'Male' AND age BETWEEN 50 AND 59 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS g6pdm9,
                (SELECT count(g6pd) FROM v_w_haematology_labs WHERE g6pd = 'Full Defect' AND gender = 'Male' AND age BETWEEN 60 AND 69 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS g6pdm10,
                (SELECT count(g6pd) FROM v_w_haematology_labs WHERE g6pd = 'Full Defect' AND gender = 'Male' AND age > 69 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS g6pdm11,
                (SELECT count(g6pd) FROM v_w_haematology_labs WHERE g6pd = 'Full Defect' AND gender = 'Male' AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS g6pdm12,
                (SELECT count(g6pd) FROM v_w_haematology_labs WHERE g6pd = 'Full Defect' AND gender = 'Female' AND age < 1 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS g6pdf1,
                (SELECT count(g6pd) FROM v_w_haematology_labs WHERE g6pd = 'Full Defect' AND gender = 'Female' AND age BETWEEN 1 AND 4 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS g6pdf2,
                (SELECT count(g6pd) FROM v_w_haematology_labs WHERE g6pd = 'Full Defect' AND gender = 'Female' AND age BETWEEN 5 AND 9 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS g6pdf3,
                (SELECT count(g6pd) FROM v_w_haematology_labs WHERE g6pd = 'Full Defect' AND gender = 'Female' AND age BETWEEN 10 AND 14 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS g6pdf4,
                (SELECT count(g6pd) FROM v_w_haematology_labs WHERE g6pd = 'Full Defect' AND gender = 'Female' AND age BETWEEN 15 AND 17 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS g6pdf5,
                (SELECT count(g6pd) FROM v_w_haematology_labs WHERE g6pd = 'Full Defect' AND gender = 'Female' AND age BETWEEN 18 AND 19 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS g6pdf6,
                (SELECT count(g6pd) FROM v_w_haematology_labs WHERE g6pd = 'Full Defect' AND gender = 'Female' AND age BETWEEN 20 AND 34 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS g6pdf7,
                (SELECT count(g6pd) FROM v_w_haematology_labs WHERE g6pd = 'Full Defect' AND gender = 'Female' AND age BETWEEN 35 AND 49 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS g6pdf8,
                (SELECT count(g6pd) FROM v_w_haematology_labs WHERE g6pd = 'Full Defect' AND gender = 'Female' AND age BETWEEN 50 AND 59 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS g6pdf9,
                (SELECT count(g6pd) FROM v_w_haematology_labs WHERE g6pd = 'Full Defect' AND gender = 'Female' AND age BETWEEN 60 AND 69 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS g6pdf10,
                (SELECT count(g6pd) FROM v_w_haematology_labs WHERE g6pd = 'Full Defect' AND gender = 'Female' AND age > 69 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS g6pdf11,
                (SELECT count(g6pd) FROM v_w_haematology_labs WHERE g6pd = 'Full Defect' AND gender = 'Female' AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS g6pdf12,
                (SELECT count(g6pd) FROM v_w_haematology_labs WHERE g6pd = 'Full Defect' AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS g6pd
            ");

        $urine_hcg = DB::select("SELECT 
                (SELECT count(urine_hcg) FROM v_w_haematology_labs WHERE urine_hcg IS NOT NULL AND gender = 'Male' AND age < 1 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS urine_hcgm1,
                (SELECT count(urine_hcg) FROM v_w_haematology_labs WHERE urine_hcg IS NOT NULL AND gender = 'Male' AND age BETWEEN 1 AND 4 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS urine_hcgm2,
                (SELECT count(urine_hcg) FROM v_w_haematology_labs WHERE urine_hcg IS NOT NULL AND gender = 'Male' AND age BETWEEN 5 AND 9 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS urine_hcgm3,
                (SELECT count(urine_hcg) FROM v_w_haematology_labs WHERE urine_hcg IS NOT NULL AND gender = 'Male' AND age BETWEEN 10 AND 14 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS urine_hcgm4,
                (SELECT count(urine_hcg) FROM v_w_haematology_labs WHERE urine_hcg IS NOT NULL AND gender = 'Male' AND age BETWEEN 15 AND 17 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS urine_hcgm5,
                (SELECT count(urine_hcg) FROM v_w_haematology_labs WHERE urine_hcg IS NOT NULL AND gender = 'Male' AND age BETWEEN 18 AND 19 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS urine_hcgm6,
                (SELECT count(urine_hcg) FROM v_w_haematology_labs WHERE urine_hcg IS NOT NULL AND gender = 'Male' AND age BETWEEN 20 AND 34 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS urine_hcgm7,
                (SELECT count(urine_hcg) FROM v_w_haematology_labs WHERE urine_hcg IS NOT NULL AND gender = 'Male' AND age BETWEEN 35 AND 49 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS urine_hcgm8,
                (SELECT count(urine_hcg) FROM v_w_haematology_labs WHERE urine_hcg IS NOT NULL AND gender = 'Male' AND age BETWEEN 50 AND 59 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS urine_hcgm9,
                (SELECT count(urine_hcg) FROM v_w_haematology_labs WHERE urine_hcg IS NOT NULL AND gender = 'Male' AND age BETWEEN 60 AND 69 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS urine_hcgm10,
                (SELECT count(urine_hcg) FROM v_w_haematology_labs WHERE urine_hcg IS NOT NULL AND gender = 'Male' AND age > 69 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS urine_hcgm11,
                (SELECT count(urine_hcg) FROM v_w_haematology_labs WHERE urine_hcg IS NOT NULL AND gender = 'Male' AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS urine_hcgm12,
                (SELECT count(urine_hcg) FROM v_w_haematology_labs WHERE urine_hcg IS NOT NULL AND gender = 'Female' AND age < 1 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS urine_hcgf1,
                (SELECT count(urine_hcg) FROM v_w_haematology_labs WHERE urine_hcg IS NOT NULL AND gender = 'Female' AND age BETWEEN 1 AND 4 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS urine_hcgf2,
                (SELECT count(urine_hcg) FROM v_w_haematology_labs WHERE urine_hcg IS NOT NULL AND gender = 'Female' AND age BETWEEN 5 AND 9 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS urine_hcgf3,
                (SELECT count(urine_hcg) FROM v_w_haematology_labs WHERE urine_hcg IS NOT NULL AND gender = 'Female' AND age BETWEEN 10 AND 14 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS urine_hcgf4,
                (SELECT count(urine_hcg) FROM v_w_haematology_labs WHERE urine_hcg IS NOT NULL AND gender = 'Female' AND age BETWEEN 15 AND 17 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS urine_hcgf5,
                (SELECT count(urine_hcg) FROM v_w_haematology_labs WHERE urine_hcg IS NOT NULL AND gender = 'Female' AND age BETWEEN 18 AND 19 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS urine_hcgf6,
                (SELECT count(urine_hcg) FROM v_w_haematology_labs WHERE urine_hcg IS NOT NULL AND gender = 'Female' AND age BETWEEN 20 AND 34 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS urine_hcgf7,
                (SELECT count(urine_hcg) FROM v_w_haematology_labs WHERE urine_hcg IS NOT NULL AND gender = 'Female' AND age BETWEEN 35 AND 49 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS urine_hcgf8,
                (SELECT count(urine_hcg) FROM v_w_haematology_labs WHERE urine_hcg IS NOT NULL AND gender = 'Female' AND age BETWEEN 50 AND 59 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS urine_hcgf9,
                (SELECT count(urine_hcg) FROM v_w_haematology_labs WHERE urine_hcg IS NOT NULL AND gender = 'Female' AND age BETWEEN 60 AND 69 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS urine_hcgf10,
                (SELECT count(urine_hcg) FROM v_w_haematology_labs WHERE urine_hcg IS NOT NULL AND gender = 'Female' AND age > 69 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS urine_hcgf11,
                (SELECT count(urine_hcg) FROM v_w_haematology_labs WHERE urine_hcg IS NOT NULL AND gender = 'Female' AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS urine_hcgf12,
                (SELECT count(urine_hcg) FROM v_w_haematology_labs WHERE urine_hcg IS NOT NULL AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS urine_hcg    
            ");

    $bf_pos = DB::select("SELECT 
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf_parasite IS NOT NULL AND gender = 'Male' AND age < 1 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bfm1,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf_parasite IS NOT NULL AND gender = 'Male' AND age BETWEEN 1 AND 4 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bfm2,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf_parasite IS NOT NULL AND gender = 'Male' AND age BETWEEN 5 AND 9 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bfm3,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf_parasite IS NOT NULL AND gender = 'Male' AND age BETWEEN 10 AND 14 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bfm4,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf_parasite IS NOT NULL AND gender = 'Male' AND age BETWEEN 15 AND 17 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bfm5,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf_parasite IS NOT NULL AND gender = 'Male' AND age BETWEEN 18 AND 19 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bfm6,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf_parasite IS NOT NULL AND gender = 'Male' AND age BETWEEN 20 AND 34 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bfm7,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf_parasite IS NOT NULL AND gender = 'Male' AND age BETWEEN 35 AND 49 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bfm8,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf_parasite IS NOT NULL AND gender = 'Male' AND age BETWEEN 50 AND 59 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bfm9,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf_parasite IS NOT NULL AND gender = 'Male' AND age BETWEEN 60 AND 69 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bfm10,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf_parasite IS NOT NULL AND gender = 'Male' AND age > 69 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bfm11,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf_parasite IS NOT NULL AND gender = 'Male' AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bfm12,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf_parasite IS NOT NULL AND gender = 'Female' AND age < 1 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bff1,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf_parasite IS NOT NULL AND gender = 'Female' AND age BETWEEN 1 AND 4 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bff2,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf_parasite IS NOT NULL AND gender = 'Female' AND age BETWEEN 5 AND 9 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bff3,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf_parasite IS NOT NULL AND gender = 'Female' AND age BETWEEN 10 AND 14 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bff4,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf_parasite IS NOT NULL AND gender = 'Female' AND age BETWEEN 15 AND 17 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bff5,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf_parasite IS NOT NULL AND gender = 'Female' AND age BETWEEN 18 AND 19 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bff6,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf_parasite IS NOT NULL AND gender = 'Female' AND age BETWEEN 20 AND 34 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bff7,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf_parasite IS NOT NULL AND gender = 'Female' AND age BETWEEN 35 AND 49 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bff8,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf_parasite IS NOT NULL AND gender = 'Female' AND age BETWEEN 50 AND 59 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bff9,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf_parasite IS NOT NULL AND gender = 'Female' AND age BETWEEN 60 AND 69 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bff10,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf_parasite IS NOT NULL AND gender = 'Female' AND age > 69 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bff11,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf_parasite IS NOT NULL AND gender = 'Female' AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bff12,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf_parasite IS NOT NULL AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bf
            ");

        $bf_neg = DB::select("SELECT 
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf IS NOT NULL AND bf_parasite IS NULL AND gender = 'Male' AND age < 1 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bfm1,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf IS NOT NULL AND bf_parasite IS NULL AND gender = 'Male' AND age BETWEEN 1 AND 4 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bfm2,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf IS NOT NULL AND bf_parasite IS NULL AND gender = 'Male' AND age BETWEEN 5 AND 9 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bfm3,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf IS NOT NULL AND bf_parasite IS NULL AND gender = 'Male' AND age BETWEEN 10 AND 14 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bfm4,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf IS NOT NULL AND bf_parasite IS NULL AND gender = 'Male' AND age BETWEEN 15 AND 17 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bfm5,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf IS NOT NULL AND bf_parasite IS NULL AND gender = 'Male' AND age BETWEEN 18 AND 19 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bfm6,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf IS NOT NULL AND bf_parasite IS NULL AND gender = 'Male' AND age BETWEEN 20 AND 34 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bfm7,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf IS NOT NULL AND bf_parasite IS NULL AND gender = 'Male' AND age BETWEEN 35 AND 49 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bfm8,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf IS NOT NULL AND bf_parasite IS NULL AND gender = 'Male' AND age BETWEEN 50 AND 59 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bfm9,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf IS NOT NULL AND bf_parasite IS NULL AND gender = 'Male' AND age BETWEEN 60 AND 69 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bfm10,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf IS NOT NULL AND bf_parasite IS NULL AND gender = 'Male' AND age > 69 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bfm11,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf IS NOT NULL AND bf_parasite IS NULL AND gender = 'Male' AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bfm12,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf IS NOT NULL AND bf_parasite IS NULL AND gender = 'Female' AND age < 1 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bff1,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf IS NOT NULL AND bf_parasite IS NULL AND gender = 'Female' AND age BETWEEN 1 AND 4 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bff2,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf IS NOT NULL AND bf_parasite IS NULL AND gender = 'Female' AND age BETWEEN 5 AND 9 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bff3,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf IS NOT NULL AND bf_parasite IS NULL AND gender = 'Female' AND age BETWEEN 10 AND 14 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bff4,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf IS NOT NULL AND bf_parasite IS NULL AND gender = 'Female' AND age BETWEEN 15 AND 17 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bff5,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf IS NOT NULL AND bf_parasite IS NULL AND gender = 'Female' AND age BETWEEN 18 AND 19 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bff6,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf IS NOT NULL AND bf_parasite IS NULL AND gender = 'Female' AND age BETWEEN 20 AND 34 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bff7,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf IS NOT NULL AND bf_parasite IS NULL AND gender = 'Female' AND age BETWEEN 35 AND 49 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bff8,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf IS NOT NULL AND bf_parasite IS NULL AND gender = 'Female' AND age BETWEEN 50 AND 59 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bff9,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf IS NOT NULL AND bf_parasite IS NULL AND gender = 'Female' AND age BETWEEN 60 AND 69 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bff10,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf IS NOT NULL AND bf_parasite IS NULL AND gender = 'Female' AND age > 69 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bff11,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf IS NOT NULL AND bf_parasite IS NULL AND gender = 'Female' AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bff12,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf IS NOT NULL AND bf_parasite IS NULL AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bf                
            ");

        $bf_neg_anc = DB::select("SELECT 
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf IS NOT NULL AND bf_parasite IS NULL AND department = 'ANC' AND gender = 'Male' AND age < 1 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bfm1,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf IS NOT NULL AND bf_parasite IS NULL AND department = 'ANC' AND gender = 'Male' AND age BETWEEN 1 AND 4 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bfm2,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf IS NOT NULL AND bf_parasite IS NULL AND department = 'ANC' AND gender = 'Male' AND age BETWEEN 5 AND 9 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bfm3,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf IS NOT NULL AND bf_parasite IS NULL AND department = 'ANC' AND gender = 'Male' AND age BETWEEN 10 AND 14 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bfm4,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf IS NOT NULL AND bf_parasite IS NULL AND department = 'ANC' AND gender = 'Male' AND age BETWEEN 15 AND 17 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bfm5,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf IS NOT NULL AND bf_parasite IS NULL AND department = 'ANC' AND gender = 'Male' AND age BETWEEN 18 AND 19 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bfm6,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf IS NOT NULL AND bf_parasite IS NULL AND department = 'ANC' AND gender = 'Male' AND age BETWEEN 20 AND 34 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bfm7,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf IS NOT NULL AND bf_parasite IS NULL AND department = 'ANC' AND gender = 'Male' AND age BETWEEN 35 AND 49 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bfm8,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf IS NOT NULL AND bf_parasite IS NULL AND department = 'ANC' AND gender = 'Male' AND age BETWEEN 50 AND 59 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bfm9,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf IS NOT NULL AND bf_parasite IS NULL AND department = 'ANC' AND gender = 'Male' AND age BETWEEN 60 AND 69 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bfm10,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf IS NOT NULL AND bf_parasite IS NULL AND department = 'ANC' AND gender = 'Male' AND age > 69 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bfm11,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf IS NOT NULL AND bf_parasite IS NULL AND department = 'ANC' AND gender = 'Male' AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bfm12,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf IS NOT NULL AND bf_parasite IS NULL AND department = 'ANC' AND gender = 'Female' AND age < 1 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bff1,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf IS NOT NULL AND bf_parasite IS NULL AND department = 'ANC' AND gender = 'Female' AND age BETWEEN 1 AND 4 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bff2,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf IS NOT NULL AND bf_parasite IS NULL AND department = 'ANC' AND gender = 'Female' AND age BETWEEN 5 AND 9 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bff3,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf IS NOT NULL AND bf_parasite IS NULL AND department = 'ANC' AND gender = 'Female' AND age BETWEEN 10 AND 14 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bff4,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf IS NOT NULL AND bf_parasite IS NULL AND department = 'ANC' AND gender = 'Female' AND age BETWEEN 15 AND 17 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bff5,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf IS NOT NULL AND bf_parasite IS NULL AND department = 'ANC' AND gender = 'Female' AND age BETWEEN 18 AND 19 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bff6,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf IS NOT NULL AND bf_parasite IS NULL AND department = 'ANC' AND gender = 'Female' AND age BETWEEN 20 AND 34 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bff7,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf IS NOT NULL AND bf_parasite IS NULL AND department = 'ANC' AND gender = 'Female' AND age BETWEEN 35 AND 49 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bff8,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf IS NOT NULL AND bf_parasite IS NULL AND department = 'ANC' AND gender = 'Female' AND age BETWEEN 50 AND 59 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bff9,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf IS NOT NULL AND bf_parasite IS NULL AND department = 'ANC' AND gender = 'Female' AND age BETWEEN 60 AND 69 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bff10,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf IS NOT NULL AND bf_parasite IS NULL AND department = 'ANC' AND gender = 'Female' AND age > 69 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bff11,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf IS NOT NULL AND bf_parasite IS NULL AND department = 'ANC' AND gender = 'Female' AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bff12,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf IS NOT NULL AND bf_parasite IS NULL AND department = 'ANC' AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bf        
            ");

        $bf_pos_anc = DB::select("SELECT 
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf_parasite IS NOT NULL AND department = 'ANC' AND gender = 'Male' AND age < 1 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bfm1,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf_parasite IS NOT NULL AND department = 'ANC' AND gender = 'Male' AND age BETWEEN 1 AND 4 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bfm2,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf_parasite IS NOT NULL AND department = 'ANC' AND gender = 'Male' AND age BETWEEN 5 AND 9 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bfm3,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf_parasite IS NOT NULL AND department = 'ANC' AND gender = 'Male' AND age BETWEEN 10 AND 14 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bfm4,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf_parasite IS NOT NULL AND department = 'ANC' AND gender = 'Male' AND age BETWEEN 15 AND 17 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bfm5,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf_parasite IS NOT NULL AND department = 'ANC' AND gender = 'Male' AND age BETWEEN 18 AND 19 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bfm6,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf_parasite IS NOT NULL AND department = 'ANC' AND gender = 'Male' AND age BETWEEN 20 AND 34 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bfm7,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf_parasite IS NOT NULL AND department = 'ANC' AND gender = 'Male' AND age BETWEEN 35 AND 49 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bfm8,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf_parasite IS NOT NULL AND department = 'ANC' AND gender = 'Male' AND age BETWEEN 50 AND 59 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bfm9,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf_parasite IS NOT NULL AND department = 'ANC' AND gender = 'Male' AND age BETWEEN 60 AND 69 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bfm10,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf_parasite IS NOT NULL AND department = 'ANC' AND gender = 'Male' AND age > 69 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bfm11,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf_parasite IS NOT NULL AND department = 'ANC' AND gender = 'Male' AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bfm12,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf_parasite IS NOT NULL AND department = 'ANC' AND gender = 'Female' AND age < 1 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bff1,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf_parasite IS NOT NULL AND department = 'ANC' AND gender = 'Female' AND age BETWEEN 1 AND 4 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bff2,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf_parasite IS NOT NULL AND department = 'ANC' AND gender = 'Female' AND age BETWEEN 5 AND 9 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bff3,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf_parasite IS NOT NULL AND department = 'ANC' AND gender = 'Female' AND age BETWEEN 10 AND 14 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bff4,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf_parasite IS NOT NULL AND department = 'ANC' AND gender = 'Female' AND age BETWEEN 15 AND 17 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bff5,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf_parasite IS NOT NULL AND department = 'ANC' AND gender = 'Female' AND age BETWEEN 18 AND 19 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bff6,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf_parasite IS NOT NULL AND department = 'ANC' AND gender = 'Female' AND age BETWEEN 20 AND 34 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bff7,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf_parasite IS NOT NULL AND department = 'ANC' AND gender = 'Female' AND age BETWEEN 35 AND 49 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bff8,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf_parasite IS NOT NULL AND department = 'ANC' AND gender = 'Female' AND age BETWEEN 50 AND 59 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bff9,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf_parasite IS NOT NULL AND department = 'ANC' AND gender = 'Female' AND age BETWEEN 60 AND 69 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bff10,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf_parasite IS NOT NULL AND department = 'ANC' AND gender = 'Female' AND age > 69 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bff11,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf_parasite IS NOT NULL AND department = 'ANC' AND gender = 'Female' AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bff12,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf_parasite IS NOT NULL AND department = 'ANC' AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bf
            ");

            $bf_neg_opd = DB::select("SELECT 
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf IS NOT NULL AND bf_parasite IS NULL AND (department = 'OBS & GYNAE' OR department = 'ENT' OR department = 'EYE' OR department = 'OPD' OR department = 'RCH' OR department = 'ANC') AND gender = 'Male' AND age < 1 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bfm1,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf IS NOT NULL AND bf_parasite IS NULL AND (department = 'OBS & GYNAE' OR department = 'ENT' OR department = 'EYE' OR department = 'OPD' OR department = 'RCH' OR department = 'ANC') AND gender = 'Male' AND age BETWEEN 1 AND 4 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bfm2,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf IS NOT NULL AND bf_parasite IS NULL AND (department = 'OBS & GYNAE' OR department = 'ENT' OR department = 'EYE' OR department = 'OPD' OR department = 'RCH' OR department = 'ANC') AND gender = 'Male' AND age BETWEEN 5 AND 9 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bfm3,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf IS NOT NULL AND bf_parasite IS NULL AND (department = 'OBS & GYNAE' OR department = 'ENT' OR department = 'EYE' OR department = 'OPD' OR department = 'RCH' OR department = 'ANC') AND gender = 'Male' AND age BETWEEN 10 AND 14 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bfm4,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf IS NOT NULL AND bf_parasite IS NULL AND (department = 'OBS & GYNAE' OR department = 'ENT' OR department = 'EYE' OR department = 'OPD' OR department = 'RCH' OR department = 'ANC') AND gender = 'Male' AND age BETWEEN 15 AND 17 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bfm5,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf IS NOT NULL AND bf_parasite IS NULL AND (department = 'OBS & GYNAE' OR department = 'ENT' OR department = 'EYE' OR department = 'OPD' OR department = 'RCH' OR department = 'ANC') AND gender = 'Male' AND age BETWEEN 18 AND 19 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bfm6,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf IS NOT NULL AND bf_parasite IS NULL AND (department = 'OBS & GYNAE' OR department = 'ENT' OR department = 'EYE' OR department = 'OPD' OR department = 'RCH' OR department = 'ANC') AND gender = 'Male' AND age BETWEEN 20 AND 34 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bfm7,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf IS NOT NULL AND bf_parasite IS NULL AND (department = 'OBS & GYNAE' OR department = 'ENT' OR department = 'EYE' OR department = 'OPD' OR department = 'RCH' OR department = 'ANC') AND gender = 'Male' AND age BETWEEN 35 AND 49 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bfm8,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf IS NOT NULL AND bf_parasite IS NULL AND (department = 'OBS & GYNAE' OR department = 'ENT' OR department = 'EYE' OR department = 'OPD' OR department = 'RCH' OR department = 'ANC') AND gender = 'Male' AND age BETWEEN 50 AND 59 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bfm9,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf IS NOT NULL AND bf_parasite IS NULL AND (department = 'OBS & GYNAE' OR department = 'ENT' OR department = 'EYE' OR department = 'OPD' OR department = 'RCH' OR department = 'ANC') AND gender = 'Male' AND age BETWEEN 60 AND 69 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bfm10,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf IS NOT NULL AND bf_parasite IS NULL AND (department = 'OBS & GYNAE' OR department = 'ENT' OR department = 'EYE' OR department = 'OPD' OR department = 'RCH' OR department = 'ANC') AND gender = 'Male' AND age > 69 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bfm11,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf IS NOT NULL AND bf_parasite IS NULL AND (department = 'OBS & GYNAE' OR department = 'ENT' OR department = 'EYE' OR department = 'OPD' OR department = 'RCH' OR department = 'ANC') AND gender = 'Male' AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bfm12,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf IS NOT NULL AND bf_parasite IS NULL AND (department = 'OBS & GYNAE' OR department = 'ENT' OR department = 'EYE' OR department = 'OPD' OR department = 'RCH' OR department = 'ANC') AND gender = 'Female' AND age < 1 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bff1,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf IS NOT NULL AND bf_parasite IS NULL AND (department = 'OBS & GYNAE' OR department = 'ENT' OR department = 'EYE' OR department = 'OPD' OR department = 'RCH' OR department = 'ANC') AND gender = 'Female' AND age BETWEEN 1 AND 4 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bff2,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf IS NOT NULL AND bf_parasite IS NULL AND (department = 'OBS & GYNAE' OR department = 'ENT' OR department = 'EYE' OR department = 'OPD' OR department = 'RCH' OR department = 'ANC') AND gender = 'Female' AND age BETWEEN 5 AND 9 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bff3,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf IS NOT NULL AND bf_parasite IS NULL AND (department = 'OBS & GYNAE' OR department = 'ENT' OR department = 'EYE' OR department = 'OPD' OR department = 'RCH' OR department = 'ANC') AND gender = 'Female' AND age BETWEEN 10 AND 14 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bff4,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf IS NOT NULL AND bf_parasite IS NULL AND (department = 'OBS & GYNAE' OR department = 'ENT' OR department = 'EYE' OR department = 'OPD' OR department = 'RCH' OR department = 'ANC') AND gender = 'Female' AND age BETWEEN 15 AND 17 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bff5,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf IS NOT NULL AND bf_parasite IS NULL AND (department = 'OBS & GYNAE' OR department = 'ENT' OR department = 'EYE' OR department = 'OPD' OR department = 'RCH' OR department = 'ANC') AND gender = 'Female' AND age BETWEEN 18 AND 19 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bff6,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf IS NOT NULL AND bf_parasite IS NULL AND (department = 'OBS & GYNAE' OR department = 'ENT' OR department = 'EYE' OR department = 'OPD' OR department = 'RCH' OR department = 'ANC') AND gender = 'Female' AND age BETWEEN 20 AND 34 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bff7,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf IS NOT NULL AND bf_parasite IS NULL AND (department = 'OBS & GYNAE' OR department = 'ENT' OR department = 'EYE' OR department = 'OPD' OR department = 'RCH' OR department = 'ANC') AND gender = 'Female' AND age BETWEEN 35 AND 49 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bff8,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf IS NOT NULL AND bf_parasite IS NULL AND (department = 'OBS & GYNAE' OR department = 'ENT' OR department = 'EYE' OR department = 'OPD' OR department = 'RCH' OR department = 'ANC') AND gender = 'Female' AND age BETWEEN 50 AND 59 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bff9,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf IS NOT NULL AND bf_parasite IS NULL AND (department = 'OBS & GYNAE' OR department = 'ENT' OR department = 'EYE' OR department = 'OPD' OR department = 'RCH' OR department = 'ANC') AND gender = 'Female' AND age BETWEEN 60 AND 69 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bff10,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf IS NOT NULL AND bf_parasite IS NULL AND (department = 'OBS & GYNAE' OR department = 'ENT' OR department = 'EYE' OR department = 'OPD' OR department = 'RCH' OR department = 'ANC') AND gender = 'Female' AND age > 69 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bff11,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf IS NOT NULL AND bf_parasite IS NULL AND (department = 'OBS & GYNAE' OR department = 'ENT' OR department = 'EYE' OR department = 'OPD' OR department = 'RCH' OR department = 'ANC') AND gender = 'Female' AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bff12,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf IS NOT NULL AND bf_parasite IS NULL AND (department = 'OBS & GYNAE' OR department = 'ENT' OR department = 'EYE' OR department = 'OPD' OR department = 'RCH' OR department = 'ANC') AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bf            
            ");

            $bf_pos_opd = DB::select("SELECT 
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf_parasite IS NOT NULL AND (department = 'OBS & GYNAE' OR department = 'ENT' OR department = 'EYE' OR department = 'OPD' OR department = 'RCH' OR department = 'ANC') AND gender = 'Male' AND age < 1 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bfm1,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf_parasite IS NOT NULL AND (department = 'OBS & GYNAE' OR department = 'ENT' OR department = 'EYE' OR department = 'OPD' OR department = 'RCH' OR department = 'ANC') AND gender = 'Male' AND age BETWEEN 1 AND 4 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bfm2,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf_parasite IS NOT NULL AND (department = 'OBS & GYNAE' OR department = 'ENT' OR department = 'EYE' OR department = 'OPD' OR department = 'RCH' OR department = 'ANC') AND gender = 'Male' AND age BETWEEN 5 AND 9 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bfm3,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf_parasite IS NOT NULL AND (department = 'OBS & GYNAE' OR department = 'ENT' OR department = 'EYE' OR department = 'OPD' OR department = 'RCH' OR department = 'ANC') AND gender = 'Male' AND age BETWEEN 10 AND 14 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bfm4,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf_parasite IS NOT NULL AND (department = 'OBS & GYNAE' OR department = 'ENT' OR department = 'EYE' OR department = 'OPD' OR department = 'RCH' OR department = 'ANC') AND gender = 'Male' AND age BETWEEN 15 AND 17 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bfm5,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf_parasite IS NOT NULL AND (department = 'OBS & GYNAE' OR department = 'ENT' OR department = 'EYE' OR department = 'OPD' OR department = 'RCH' OR department = 'ANC') AND gender = 'Male' AND age BETWEEN 18 AND 19 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bfm6,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf_parasite IS NOT NULL AND (department = 'OBS & GYNAE' OR department = 'ENT' OR department = 'EYE' OR department = 'OPD' OR department = 'RCH' OR department = 'ANC') AND gender = 'Male' AND age BETWEEN 20 AND 34 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bfm7,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf_parasite IS NOT NULL AND (department = 'OBS & GYNAE' OR department = 'ENT' OR department = 'EYE' OR department = 'OPD' OR department = 'RCH' OR department = 'ANC') AND gender = 'Male' AND age BETWEEN 35 AND 49 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bfm8,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf_parasite IS NOT NULL AND (department = 'OBS & GYNAE' OR department = 'ENT' OR department = 'EYE' OR department = 'OPD' OR department = 'RCH' OR department = 'ANC') AND gender = 'Male' AND age BETWEEN 50 AND 59 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bfm9,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf_parasite IS NOT NULL AND (department = 'OBS & GYNAE' OR department = 'ENT' OR department = 'EYE' OR department = 'OPD' OR department = 'RCH' OR department = 'ANC') AND gender = 'Male' AND age BETWEEN 60 AND 69 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bfm10,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf_parasite IS NOT NULL AND (department = 'OBS & GYNAE' OR department = 'ENT' OR department = 'EYE' OR department = 'OPD' OR department = 'RCH' OR department = 'ANC') AND gender = 'Male' AND age > 69 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bfm11,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf_parasite IS NOT NULL AND (department = 'OBS & GYNAE' OR department = 'ENT' OR department = 'EYE' OR department = 'OPD' OR department = 'RCH' OR department = 'ANC') AND gender = 'Male' AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bfm12,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf_parasite IS NOT NULL AND (department = 'OBS & GYNAE' OR department = 'ENT' OR department = 'EYE' OR department = 'OPD' OR department = 'RCH' OR department = 'ANC') AND gender = 'Female' AND age < 1 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bff1,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf_parasite IS NOT NULL AND (department = 'OBS & GYNAE' OR department = 'ENT' OR department = 'EYE' OR department = 'OPD' OR department = 'RCH' OR department = 'ANC') AND gender = 'Female' AND age BETWEEN 1 AND 4 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bff2,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf_parasite IS NOT NULL AND (department = 'OBS & GYNAE' OR department = 'ENT' OR department = 'EYE' OR department = 'OPD' OR department = 'RCH' OR department = 'ANC') AND gender = 'Female' AND age BETWEEN 5 AND 9 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bff3,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf_parasite IS NOT NULL AND (department = 'OBS & GYNAE' OR department = 'ENT' OR department = 'EYE' OR department = 'OPD' OR department = 'RCH' OR department = 'ANC') AND gender = 'Female' AND age BETWEEN 10 AND 14 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bff4,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf_parasite IS NOT NULL AND (department = 'OBS & GYNAE' OR department = 'ENT' OR department = 'EYE' OR department = 'OPD' OR department = 'RCH' OR department = 'ANC') AND gender = 'Female' AND age BETWEEN 15 AND 17 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bff5,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf_parasite IS NOT NULL AND (department = 'OBS & GYNAE' OR department = 'ENT' OR department = 'EYE' OR department = 'OPD' OR department = 'RCH' OR department = 'ANC') AND gender = 'Female' AND age BETWEEN 18 AND 19 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bff6,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf_parasite IS NOT NULL AND (department = 'OBS & GYNAE' OR department = 'ENT' OR department = 'EYE' OR department = 'OPD' OR department = 'RCH' OR department = 'ANC') AND gender = 'Female' AND age BETWEEN 20 AND 34 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bff7,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf_parasite IS NOT NULL AND (department = 'OBS & GYNAE' OR department = 'ENT' OR department = 'EYE' OR department = 'OPD' OR department = 'RCH' OR department = 'ANC') AND gender = 'Female' AND age BETWEEN 35 AND 49 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bff8,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf_parasite IS NOT NULL AND (department = 'OBS & GYNAE' OR department = 'ENT' OR department = 'EYE' OR department = 'OPD' OR department = 'RCH' OR department = 'ANC') AND gender = 'Female' AND age BETWEEN 50 AND 59 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bff9,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf_parasite IS NOT NULL AND (department = 'OBS & GYNAE' OR department = 'ENT' OR department = 'EYE' OR department = 'OPD' OR department = 'RCH' OR department = 'ANC') AND gender = 'Female' AND age BETWEEN 60 AND 69 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bff10,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf_parasite IS NOT NULL AND (department = 'OBS & GYNAE' OR department = 'ENT' OR department = 'EYE' OR department = 'OPD' OR department = 'RCH' OR department = 'ANC') AND gender = 'Female' AND age > 69 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bff11,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf_parasite IS NOT NULL AND (department = 'OBS & GYNAE' OR department = 'ENT' OR department = 'EYE' OR department = 'OPD' OR department = 'RCH' OR department = 'ANC') AND gender = 'Female' AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bff12,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf_parasite IS NOT NULL AND (department = 'OBS & GYNAE' OR department = 'ENT' OR department = 'EYE' OR department = 'OPD' OR department = 'RCH' OR department = 'ANC') AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bf    
            ");

        $bf_neg_ipd = DB::select("SELECT 
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf IS NOT NULL AND bf_parasite IS NULL AND (department = 'Emergency' OR department = 'General Ward' OR department = 'Maternity Ward' OR department = 'Orthopaedic Ward' OR department = 'Surgical Ward' OR department = 'NICU' OR department = 'Childrens Ward') AND gender = 'Male' AND age < 1 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bfm1,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf IS NOT NULL AND bf_parasite IS NULL AND (department = 'Emergency' OR department = 'General Ward' OR department = 'Maternity Ward' OR department = 'Orthopaedic Ward' OR department = 'Surgical Ward' OR department = 'NICU' OR department = 'Childrens Ward') AND gender = 'Male' AND age BETWEEN 1 AND 4 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bfm2,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf IS NOT NULL AND bf_parasite IS NULL AND (department = 'Emergency' OR department = 'General Ward' OR department = 'Maternity Ward' OR department = 'Orthopaedic Ward' OR department = 'Surgical Ward' OR department = 'NICU' OR department = 'Childrens Ward') AND gender = 'Male' AND age BETWEEN 5 AND 9 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bfm3,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf IS NOT NULL AND bf_parasite IS NULL AND (department = 'Emergency' OR department = 'General Ward' OR department = 'Maternity Ward' OR department = 'Orthopaedic Ward' OR department = 'Surgical Ward' OR department = 'NICU' OR department = 'Childrens Ward') AND gender = 'Male' AND age BETWEEN 10 AND 14 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bfm4,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf IS NOT NULL AND bf_parasite IS NULL AND (department = 'Emergency' OR department = 'General Ward' OR department = 'Maternity Ward' OR department = 'Orthopaedic Ward' OR department = 'Surgical Ward' OR department = 'NICU' OR department = 'Childrens Ward') AND gender = 'Male' AND age BETWEEN 15 AND 17 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bfm5,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf IS NOT NULL AND bf_parasite IS NULL AND (department = 'Emergency' OR department = 'General Ward' OR department = 'Maternity Ward' OR department = 'Orthopaedic Ward' OR department = 'Surgical Ward' OR department = 'NICU' OR department = 'Childrens Ward') AND gender = 'Male' AND age BETWEEN 18 AND 19 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bfm6,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf IS NOT NULL AND bf_parasite IS NULL AND (department = 'Emergency' OR department = 'General Ward' OR department = 'Maternity Ward' OR department = 'Orthopaedic Ward' OR department = 'Surgical Ward' OR department = 'NICU' OR department = 'Childrens Ward') AND gender = 'Male' AND age BETWEEN 20 AND 34 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bfm7,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf IS NOT NULL AND bf_parasite IS NULL AND (department = 'Emergency' OR department = 'General Ward' OR department = 'Maternity Ward' OR department = 'Orthopaedic Ward' OR department = 'Surgical Ward' OR department = 'NICU' OR department = 'Childrens Ward') AND gender = 'Male' AND age BETWEEN 35 AND 49 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bfm8,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf IS NOT NULL AND bf_parasite IS NULL AND (department = 'Emergency' OR department = 'General Ward' OR department = 'Maternity Ward' OR department = 'Orthopaedic Ward' OR department = 'Surgical Ward' OR department = 'NICU' OR department = 'Childrens Ward') AND gender = 'Male' AND age BETWEEN 50 AND 59 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bfm9,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf IS NOT NULL AND bf_parasite IS NULL AND (department = 'Emergency' OR department = 'General Ward' OR department = 'Maternity Ward' OR department = 'Orthopaedic Ward' OR department = 'Surgical Ward' OR department = 'NICU' OR department = 'Childrens Ward') AND gender = 'Male' AND age BETWEEN 60 AND 69 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bfm10,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf IS NOT NULL AND bf_parasite IS NULL AND (department = 'Emergency' OR department = 'General Ward' OR department = 'Maternity Ward' OR department = 'Orthopaedic Ward' OR department = 'Surgical Ward' OR department = 'NICU' OR department = 'Childrens Ward') AND gender = 'Male' AND age > 69 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bfm11,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf IS NOT NULL AND bf_parasite IS NULL AND (department = 'Emergency' OR department = 'General Ward' OR department = 'Maternity Ward' OR department = 'Orthopaedic Ward' OR department = 'Surgical Ward' OR department = 'NICU' OR department = 'Childrens Ward') AND gender = 'Male' AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bfm12,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf IS NOT NULL AND bf_parasite IS NULL AND (department = 'Emergency' OR department = 'General Ward' OR department = 'Maternity Ward' OR department = 'Orthopaedic Ward' OR department = 'Surgical Ward' OR department = 'NICU' OR department = 'Childrens Ward') AND gender = 'Female' AND age < 1 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bff1,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf IS NOT NULL AND bf_parasite IS NULL AND (department = 'Emergency' OR department = 'General Ward' OR department = 'Maternity Ward' OR department = 'Orthopaedic Ward' OR department = 'Surgical Ward' OR department = 'NICU' OR department = 'Childrens Ward') AND gender = 'Female' AND age BETWEEN 1 AND 4 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bff2,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf IS NOT NULL AND bf_parasite IS NULL AND (department = 'Emergency' OR department = 'General Ward' OR department = 'Maternity Ward' OR department = 'Orthopaedic Ward' OR department = 'Surgical Ward' OR department = 'NICU' OR department = 'Childrens Ward') AND gender = 'Female' AND age BETWEEN 5 AND 9 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bff3,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf IS NOT NULL AND bf_parasite IS NULL AND (department = 'Emergency' OR department = 'General Ward' OR department = 'Maternity Ward' OR department = 'Orthopaedic Ward' OR department = 'Surgical Ward' OR department = 'NICU' OR department = 'Childrens Ward') AND gender = 'Female' AND age BETWEEN 10 AND 14 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bff4,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf IS NOT NULL AND bf_parasite IS NULL AND (department = 'Emergency' OR department = 'General Ward' OR department = 'Maternity Ward' OR department = 'Orthopaedic Ward' OR department = 'Surgical Ward' OR department = 'NICU' OR department = 'Childrens Ward') AND gender = 'Female' AND age BETWEEN 15 AND 17 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bff5,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf IS NOT NULL AND bf_parasite IS NULL AND (department = 'Emergency' OR department = 'General Ward' OR department = 'Maternity Ward' OR department = 'Orthopaedic Ward' OR department = 'Surgical Ward' OR department = 'NICU' OR department = 'Childrens Ward') AND gender = 'Female' AND age BETWEEN 18 AND 19 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bff6,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf IS NOT NULL AND bf_parasite IS NULL AND (department = 'Emergency' OR department = 'General Ward' OR department = 'Maternity Ward' OR department = 'Orthopaedic Ward' OR department = 'Surgical Ward' OR department = 'NICU' OR department = 'Childrens Ward') AND gender = 'Female' AND age BETWEEN 20 AND 34 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bff7,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf IS NOT NULL AND bf_parasite IS NULL AND (department = 'Emergency' OR department = 'General Ward' OR department = 'Maternity Ward' OR department = 'Orthopaedic Ward' OR department = 'Surgical Ward' OR department = 'NICU' OR department = 'Childrens Ward') AND gender = 'Female' AND age BETWEEN 35 AND 49 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bff8,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf IS NOT NULL AND bf_parasite IS NULL AND (department = 'Emergency' OR department = 'General Ward' OR department = 'Maternity Ward' OR department = 'Orthopaedic Ward' OR department = 'Surgical Ward' OR department = 'NICU' OR department = 'Childrens Ward') AND gender = 'Female' AND age BETWEEN 50 AND 59 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bff9,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf IS NOT NULL AND bf_parasite IS NULL AND (department = 'Emergency' OR department = 'General Ward' OR department = 'Maternity Ward' OR department = 'Orthopaedic Ward' OR department = 'Surgical Ward' OR department = 'NICU' OR department = 'Childrens Ward') AND gender = 'Female' AND age BETWEEN 60 AND 69 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bff10,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf IS NOT NULL AND bf_parasite IS NULL AND (department = 'Emergency' OR department = 'General Ward' OR department = 'Maternity Ward' OR department = 'Orthopaedic Ward' OR department = 'Surgical Ward' OR department = 'NICU' OR department = 'Childrens Ward') AND gender = 'Female' AND age > 69 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bff11,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf IS NOT NULL AND bf_parasite IS NULL AND (department = 'Emergency' OR department = 'General Ward' OR department = 'Maternity Ward' OR department = 'Orthopaedic Ward' OR department = 'Surgical Ward' OR department = 'NICU' OR department = 'Childrens Ward') AND gender = 'Female' AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bff12,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf IS NOT NULL AND bf_parasite IS NULL AND (department = 'Emergency' OR department = 'General Ward' OR department = 'Maternity Ward' OR department = 'Orthopaedic Ward' OR department = 'Surgical Ward' OR department = 'NICU' OR department = 'Childrens Ward') AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bf
            ");

        $bf_pos_ipd = DB::select("SELECT 
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf_parasite IS NOT NULL AND (department = 'Emergency' OR department = 'General Ward' OR department = 'Maternity Ward' OR department = 'Orthopaedic Ward' OR department = 'Surgical Ward' OR department = 'NICU' OR department = 'Childrens Ward') AND gender = 'Male' AND age < 1 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bfm1,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf_parasite IS NOT NULL AND (department = 'Emergency' OR department = 'General Ward' OR department = 'Maternity Ward' OR department = 'Orthopaedic Ward' OR department = 'Surgical Ward' OR department = 'NICU' OR department = 'Childrens Ward') AND gender = 'Male' AND age BETWEEN 1 AND 4 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bfm2,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf_parasite IS NOT NULL AND (department = 'Emergency' OR department = 'General Ward' OR department = 'Maternity Ward' OR department = 'Orthopaedic Ward' OR department = 'Surgical Ward' OR department = 'NICU' OR department = 'Childrens Ward') AND gender = 'Male' AND age BETWEEN 5 AND 9 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bfm3,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf_parasite IS NOT NULL AND (department = 'Emergency' OR department = 'General Ward' OR department = 'Maternity Ward' OR department = 'Orthopaedic Ward' OR department = 'Surgical Ward' OR department = 'NICU' OR department = 'Childrens Ward') AND gender = 'Male' AND age BETWEEN 10 AND 14 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bfm4,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf_parasite IS NOT NULL AND (department = 'Emergency' OR department = 'General Ward' OR department = 'Maternity Ward' OR department = 'Orthopaedic Ward' OR department = 'Surgical Ward' OR department = 'NICU' OR department = 'Childrens Ward') AND gender = 'Male' AND age BETWEEN 15 AND 17 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bfm5,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf_parasite IS NOT NULL AND (department = 'Emergency' OR department = 'General Ward' OR department = 'Maternity Ward' OR department = 'Orthopaedic Ward' OR department = 'Surgical Ward' OR department = 'NICU' OR department = 'Childrens Ward') AND gender = 'Male' AND age BETWEEN 18 AND 19 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bfm6,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf_parasite IS NOT NULL AND (department = 'Emergency' OR department = 'General Ward' OR department = 'Maternity Ward' OR department = 'Orthopaedic Ward' OR department = 'Surgical Ward' OR department = 'NICU' OR department = 'Childrens Ward') AND gender = 'Male' AND age BETWEEN 20 AND 34 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bfm7,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf_parasite IS NOT NULL AND (department = 'Emergency' OR department = 'General Ward' OR department = 'Maternity Ward' OR department = 'Orthopaedic Ward' OR department = 'Surgical Ward' OR department = 'NICU' OR department = 'Childrens Ward') AND gender = 'Male' AND age BETWEEN 35 AND 49 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bfm8,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf_parasite IS NOT NULL AND (department = 'Emergency' OR department = 'General Ward' OR department = 'Maternity Ward' OR department = 'Orthopaedic Ward' OR department = 'Surgical Ward' OR department = 'NICU' OR department = 'Childrens Ward') AND gender = 'Male' AND age BETWEEN 50 AND 59 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bfm9,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf_parasite IS NOT NULL AND (department = 'Emergency' OR department = 'General Ward' OR department = 'Maternity Ward' OR department = 'Orthopaedic Ward' OR department = 'Surgical Ward' OR department = 'NICU' OR department = 'Childrens Ward') AND gender = 'Male' AND age BETWEEN 60 AND 69 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bfm10,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf_parasite IS NOT NULL AND (department = 'Emergency' OR department = 'General Ward' OR department = 'Maternity Ward' OR department = 'Orthopaedic Ward' OR department = 'Surgical Ward' OR department = 'NICU' OR department = 'Childrens Ward') AND gender = 'Male' AND age > 69 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bfm11,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf_parasite IS NOT NULL AND (department = 'Emergency' OR department = 'General Ward' OR department = 'Maternity Ward' OR department = 'Orthopaedic Ward' OR department = 'Surgical Ward' OR department = 'NICU' OR department = 'Childrens Ward') AND gender = 'Male' AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bfm12,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf_parasite IS NOT NULL AND (department = 'Emergency' OR department = 'General Ward' OR department = 'Maternity Ward' OR department = 'Orthopaedic Ward' OR department = 'Surgical Ward' OR department = 'NICU' OR department = 'Childrens Ward') AND gender = 'Female' AND age < 1 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bff1,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf_parasite IS NOT NULL AND (department = 'Emergency' OR department = 'General Ward' OR department = 'Maternity Ward' OR department = 'Orthopaedic Ward' OR department = 'Surgical Ward' OR department = 'NICU' OR department = 'Childrens Ward') AND gender = 'Female' AND age BETWEEN 1 AND 4 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bff2,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf_parasite IS NOT NULL AND (department = 'Emergency' OR department = 'General Ward' OR department = 'Maternity Ward' OR department = 'Orthopaedic Ward' OR department = 'Surgical Ward' OR department = 'NICU' OR department = 'Childrens Ward') AND gender = 'Female' AND age BETWEEN 5 AND 9 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bff3,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf_parasite IS NOT NULL AND (department = 'Emergency' OR department = 'General Ward' OR department = 'Maternity Ward' OR department = 'Orthopaedic Ward' OR department = 'Surgical Ward' OR department = 'NICU' OR department = 'Childrens Ward') AND gender = 'Female' AND age BETWEEN 10 AND 14 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bff4,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf_parasite IS NOT NULL AND (department = 'Emergency' OR department = 'General Ward' OR department = 'Maternity Ward' OR department = 'Orthopaedic Ward' OR department = 'Surgical Ward' OR department = 'NICU' OR department = 'Childrens Ward') AND gender = 'Female' AND age BETWEEN 15 AND 17 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bff5,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf_parasite IS NOT NULL AND (department = 'Emergency' OR department = 'General Ward' OR department = 'Maternity Ward' OR department = 'Orthopaedic Ward' OR department = 'Surgical Ward' OR department = 'NICU' OR department = 'Childrens Ward') AND gender = 'Female' AND age BETWEEN 18 AND 19 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bff6,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf_parasite IS NOT NULL AND (department = 'Emergency' OR department = 'General Ward' OR department = 'Maternity Ward' OR department = 'Orthopaedic Ward' OR department = 'Surgical Ward' OR department = 'NICU' OR department = 'Childrens Ward') AND gender = 'Female' AND age BETWEEN 20 AND 34 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bff7,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf_parasite IS NOT NULL AND (department = 'Emergency' OR department = 'General Ward' OR department = 'Maternity Ward' OR department = 'Orthopaedic Ward' OR department = 'Surgical Ward' OR department = 'NICU' OR department = 'Childrens Ward') AND gender = 'Female' AND age BETWEEN 35 AND 49 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bff8,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf_parasite IS NOT NULL AND (department = 'Emergency' OR department = 'General Ward' OR department = 'Maternity Ward' OR department = 'Orthopaedic Ward' OR department = 'Surgical Ward' OR department = 'NICU' OR department = 'Childrens Ward') AND gender = 'Female' AND age BETWEEN 50 AND 59 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bff9,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf_parasite IS NOT NULL AND (department = 'Emergency' OR department = 'General Ward' OR department = 'Maternity Ward' OR department = 'Orthopaedic Ward' OR department = 'Surgical Ward' OR department = 'NICU' OR department = 'Childrens Ward') AND gender = 'Female' AND age BETWEEN 60 AND 69 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bff10,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf_parasite IS NOT NULL AND (department = 'Emergency' OR department = 'General Ward' OR department = 'Maternity Ward' OR department = 'Orthopaedic Ward' OR department = 'Surgical Ward' OR department = 'NICU' OR department = 'Childrens Ward') AND gender = 'Female' AND age > 69 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bff11,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf_parasite IS NOT NULL AND (department = 'Emergency' OR department = 'General Ward' OR department = 'Maternity Ward' OR department = 'Orthopaedic Ward' OR department = 'Surgical Ward' OR department = 'NICU' OR department = 'Childrens Ward') AND gender = 'Female' AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bff12,
                (SELECT count(bf) FROM v_w_haematology_labs WHERE bf_parasite IS NOT NULL AND (department = 'Emergency' OR department = 'General Ward' OR department = 'Maternity Ward' OR department = 'Orthopaedic Ward' OR department = 'Surgical Ward' OR department = 'NICU' OR department = 'Childrens Ward') AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS bf
            ");

        $rdt_pf_pos = DB::select("SELECT 
                (SELECT count(rdt_pf) FROM v_w_haematology_labs WHERE rdt_pf = 'Positive' AND gender = 'Male' AND age < 1 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS rdt_pfm1,
                (SELECT count(rdt_pf) FROM v_w_haematology_labs WHERE rdt_pf = 'Positive' AND gender = 'Male' AND age BETWEEN 1 AND 4 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS rdt_pfm2,
                (SELECT count(rdt_pf) FROM v_w_haematology_labs WHERE rdt_pf = 'Positive' AND gender = 'Male' AND age BETWEEN 5 AND 9 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS rdt_pfm3,
                (SELECT count(rdt_pf) FROM v_w_haematology_labs WHERE rdt_pf = 'Positive' AND gender = 'Male' AND age BETWEEN 10 AND 14 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS rdt_pfm4,
                (SELECT count(rdt_pf) FROM v_w_haematology_labs WHERE rdt_pf = 'Positive' AND gender = 'Male' AND age BETWEEN 15 AND 17 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS rdt_pfm5,
                (SELECT count(rdt_pf) FROM v_w_haematology_labs WHERE rdt_pf = 'Positive' AND gender = 'Male' AND age BETWEEN 18 AND 19 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS rdt_pfm6,
                (SELECT count(rdt_pf) FROM v_w_haematology_labs WHERE rdt_pf = 'Positive' AND gender = 'Male' AND age BETWEEN 20 AND 34 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS rdt_pfm7,
                (SELECT count(rdt_pf) FROM v_w_haematology_labs WHERE rdt_pf = 'Positive' AND gender = 'Male' AND age BETWEEN 35 AND 49 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS rdt_pfm8,
                (SELECT count(rdt_pf) FROM v_w_haematology_labs WHERE rdt_pf = 'Positive' AND gender = 'Male' AND age BETWEEN 50 AND 59 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS rdt_pfm9,
                (SELECT count(rdt_pf) FROM v_w_haematology_labs WHERE rdt_pf = 'Positive' AND gender = 'Male' AND age BETWEEN 60 AND 69 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS rdt_pfm10,
                (SELECT count(rdt_pf) FROM v_w_haematology_labs WHERE rdt_pf = 'Positive' AND gender = 'Male' AND age > 69 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS rdt_pfm11,
                (SELECT count(rdt_pf) FROM v_w_haematology_labs WHERE rdt_pf = 'Positive' AND gender = 'Male' AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS rdt_pfm12,
                (SELECT count(rdt_pf) FROM v_w_haematology_labs WHERE rdt_pf = 'Positive' AND gender = 'Female' AND age < 1 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS rdt_pff1,
                (SELECT count(rdt_pf) FROM v_w_haematology_labs WHERE rdt_pf = 'Positive' AND gender = 'Female' AND age BETWEEN 1 AND 4 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS rdt_pff2,
                (SELECT count(rdt_pf) FROM v_w_haematology_labs WHERE rdt_pf = 'Positive' AND gender = 'Female' AND age BETWEEN 5 AND 9 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS rdt_pff3,
                (SELECT count(rdt_pf) FROM v_w_haematology_labs WHERE rdt_pf = 'Positive' AND gender = 'Female' AND age BETWEEN 10 AND 14 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS rdt_pff4,
                (SELECT count(rdt_pf) FROM v_w_haematology_labs WHERE rdt_pf = 'Positive' AND gender = 'Female' AND age BETWEEN 15 AND 17 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS rdt_pff5,
                (SELECT count(rdt_pf) FROM v_w_haematology_labs WHERE rdt_pf = 'Positive' AND gender = 'Female' AND age BETWEEN 18 AND 19 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS rdt_pff6,
                (SELECT count(rdt_pf) FROM v_w_haematology_labs WHERE rdt_pf = 'Positive' AND gender = 'Female' AND age BETWEEN 20 AND 34 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS rdt_pff7,
                (SELECT count(rdt_pf) FROM v_w_haematology_labs WHERE rdt_pf = 'Positive' AND gender = 'Female' AND age BETWEEN 35 AND 49 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS rdt_pff8,
                (SELECT count(rdt_pf) FROM v_w_haematology_labs WHERE rdt_pf = 'Positive' AND gender = 'Female' AND age BETWEEN 50 AND 59 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS rdt_pff9,
                (SELECT count(rdt_pf) FROM v_w_haematology_labs WHERE rdt_pf = 'Positive' AND gender = 'Female' AND age BETWEEN 60 AND 69 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS rdt_pff10,
                (SELECT count(rdt_pf) FROM v_w_haematology_labs WHERE rdt_pf = 'Positive' AND gender = 'Female' AND age > 69 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS rdt_pff11,
                (SELECT count(rdt_pf) FROM v_w_haematology_labs WHERE rdt_pf = 'Positive' AND gender = 'Female' AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS rdt_pff12,
                (SELECT count(rdt_pf) FROM v_w_haematology_labs WHERE rdt_pf = 'Positive' AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS rdt_pf
            ");

        $rdt_pf_neg = DB::select("SELECT 
                (SELECT count(rdt_pf) FROM v_w_haematology_labs WHERE rdt_pf = 'Negative' AND gender = 'Male' AND age < 1 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS rdt_pfm1,
                (SELECT count(rdt_pf) FROM v_w_haematology_labs WHERE rdt_pf = 'Negative' AND gender = 'Male' AND age BETWEEN 1 AND 4 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS rdt_pfm2,
                (SELECT count(rdt_pf) FROM v_w_haematology_labs WHERE rdt_pf = 'Negative' AND gender = 'Male' AND age BETWEEN 5 AND 9 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS rdt_pfm3,
                (SELECT count(rdt_pf) FROM v_w_haematology_labs WHERE rdt_pf = 'Negative' AND gender = 'Male' AND age BETWEEN 10 AND 14 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS rdt_pfm4,
                (SELECT count(rdt_pf) FROM v_w_haematology_labs WHERE rdt_pf = 'Negative' AND gender = 'Male' AND age BETWEEN 15 AND 17 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS rdt_pfm5,
                (SELECT count(rdt_pf) FROM v_w_haematology_labs WHERE rdt_pf = 'Negative' AND gender = 'Male' AND age BETWEEN 18 AND 19 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS rdt_pfm6,
                (SELECT count(rdt_pf) FROM v_w_haematology_labs WHERE rdt_pf = 'Negative' AND gender = 'Male' AND age BETWEEN 20 AND 34 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS rdt_pfm7,
                (SELECT count(rdt_pf) FROM v_w_haematology_labs WHERE rdt_pf = 'Negative' AND gender = 'Male' AND age BETWEEN 35 AND 49 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS rdt_pfm8,
                (SELECT count(rdt_pf) FROM v_w_haematology_labs WHERE rdt_pf = 'Negative' AND gender = 'Male' AND age BETWEEN 50 AND 59 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS rdt_pfm9,
                (SELECT count(rdt_pf) FROM v_w_haematology_labs WHERE rdt_pf = 'Negative' AND gender = 'Male' AND age BETWEEN 60 AND 69 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS rdt_pfm10,
                (SELECT count(rdt_pf) FROM v_w_haematology_labs WHERE rdt_pf = 'Negative' AND gender = 'Male' AND age > 69 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS rdt_pfm11,
                (SELECT count(rdt_pf) FROM v_w_haematology_labs WHERE rdt_pf = 'Negative' AND gender = 'Male' AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS rdt_pfm12,
                (SELECT count(rdt_pf) FROM v_w_haematology_labs WHERE rdt_pf = 'Negative' AND gender = 'Female' AND age < 1 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS rdt_pff1,
                (SELECT count(rdt_pf) FROM v_w_haematology_labs WHERE rdt_pf = 'Negative' AND gender = 'Female' AND age BETWEEN 1 AND 4 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS rdt_pff2,
                (SELECT count(rdt_pf) FROM v_w_haematology_labs WHERE rdt_pf = 'Negative' AND gender = 'Female' AND age BETWEEN 5 AND 9 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS rdt_pff3,
                (SELECT count(rdt_pf) FROM v_w_haematology_labs WHERE rdt_pf = 'Negative' AND gender = 'Female' AND age BETWEEN 10 AND 14 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS rdt_pff4,
                (SELECT count(rdt_pf) FROM v_w_haematology_labs WHERE rdt_pf = 'Negative' AND gender = 'Female' AND age BETWEEN 15 AND 17 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS rdt_pff5,
                (SELECT count(rdt_pf) FROM v_w_haematology_labs WHERE rdt_pf = 'Negative' AND gender = 'Female' AND age BETWEEN 18 AND 19 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS rdt_pff6,
                (SELECT count(rdt_pf) FROM v_w_haematology_labs WHERE rdt_pf = 'Negative' AND gender = 'Female' AND age BETWEEN 20 AND 34 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS rdt_pff7,
                (SELECT count(rdt_pf) FROM v_w_haematology_labs WHERE rdt_pf = 'Negative' AND gender = 'Female' AND age BETWEEN 35 AND 49 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS rdt_pff8,
                (SELECT count(rdt_pf) FROM v_w_haematology_labs WHERE rdt_pf = 'Negative' AND gender = 'Female' AND age BETWEEN 50 AND 59 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS rdt_pff9,
                (SELECT count(rdt_pf) FROM v_w_haematology_labs WHERE rdt_pf = 'Negative' AND gender = 'Female' AND age BETWEEN 60 AND 69 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS rdt_pff10,
                (SELECT count(rdt_pf) FROM v_w_haematology_labs WHERE rdt_pf = 'Negative' AND gender = 'Female' AND age > 69 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS rdt_pff11,
                (SELECT count(rdt_pf) FROM v_w_haematology_labs WHERE rdt_pf = 'Negative' AND gender = 'Female' AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS rdt_pff12,
                (SELECT count(rdt_pf) FROM v_w_haematology_labs WHERE rdt_pf = 'Negative' AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS rdt_pf
            ");

        $esr = DB::select("SELECT 
                (SELECT count(esr) FROM v_w_haematology_labs WHERE esr IS NOT NULL AND gender = 'Male' AND age < 1 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS esrm1,
                (SELECT count(esr) FROM v_w_haematology_labs WHERE esr IS NOT NULL AND gender = 'Male' AND age BETWEEN 1 AND 4 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS esrm2,
                (SELECT count(esr) FROM v_w_haematology_labs WHERE esr IS NOT NULL AND gender = 'Male' AND age BETWEEN 5 AND 9 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS esrm3,
                (SELECT count(esr) FROM v_w_haematology_labs WHERE esr IS NOT NULL AND gender = 'Male' AND age BETWEEN 10 AND 14 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS esrm4,
                (SELECT count(esr) FROM v_w_haematology_labs WHERE esr IS NOT NULL AND gender = 'Male' AND age BETWEEN 15 AND 17 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS esrm5,
                (SELECT count(esr) FROM v_w_haematology_labs WHERE esr IS NOT NULL AND gender = 'Male' AND age BETWEEN 18 AND 19 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS esrm6,
                (SELECT count(esr) FROM v_w_haematology_labs WHERE esr IS NOT NULL AND gender = 'Male' AND age BETWEEN 20 AND 34 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS esrm7,
                (SELECT count(esr) FROM v_w_haematology_labs WHERE esr IS NOT NULL AND gender = 'Male' AND age BETWEEN 35 AND 49 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS esrm8,
                (SELECT count(esr) FROM v_w_haematology_labs WHERE esr IS NOT NULL AND gender = 'Male' AND age BETWEEN 50 AND 59 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS esrm9,
                (SELECT count(esr) FROM v_w_haematology_labs WHERE esr IS NOT NULL AND gender = 'Male' AND age BETWEEN 60 AND 69 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS esrm10,
                (SELECT count(esr) FROM v_w_haematology_labs WHERE esr IS NOT NULL AND gender = 'Male' AND age > 69 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS esrm11,
                (SELECT count(esr) FROM v_w_haematology_labs WHERE esr IS NOT NULL AND gender = 'Male' AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS esrm12,
                (SELECT count(esr) FROM v_w_haematology_labs WHERE esr IS NOT NULL AND gender = 'Female' AND age < 1 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS esrf1,
                (SELECT count(esr) FROM v_w_haematology_labs WHERE esr IS NOT NULL AND gender = 'Female' AND age BETWEEN 1 AND 4 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS esrf2,
                (SELECT count(esr) FROM v_w_haematology_labs WHERE esr IS NOT NULL AND gender = 'Female' AND age BETWEEN 5 AND 9 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS esrf3,
                (SELECT count(esr) FROM v_w_haematology_labs WHERE esr IS NOT NULL AND gender = 'Female' AND age BETWEEN 10 AND 14 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS esrf4,
                (SELECT count(esr) FROM v_w_haematology_labs WHERE esr IS NOT NULL AND gender = 'Female' AND age BETWEEN 15 AND 17 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS esrf5,
                (SELECT count(esr) FROM v_w_haematology_labs WHERE esr IS NOT NULL AND gender = 'Female' AND age BETWEEN 18 AND 19 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS esrf6,
                (SELECT count(esr) FROM v_w_haematology_labs WHERE esr IS NOT NULL AND gender = 'Female' AND age BETWEEN 20 AND 34 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS esrf7,
                (SELECT count(esr) FROM v_w_haematology_labs WHERE esr IS NOT NULL AND gender = 'Female' AND age BETWEEN 35 AND 49 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS esrf8,
                (SELECT count(esr) FROM v_w_haematology_labs WHERE esr IS NOT NULL AND gender = 'Female' AND age BETWEEN 50 AND 59 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS esrf9,
                (SELECT count(esr) FROM v_w_haematology_labs WHERE esr IS NOT NULL AND gender = 'Female' AND age BETWEEN 60 AND 69 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS esrf10,
                (SELECT count(esr) FROM v_w_haematology_labs WHERE esr IS NOT NULL AND gender = 'Female' AND age > 69 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS esrf11,
                (SELECT count(esr) FROM v_w_haematology_labs WHERE esr IS NOT NULL AND gender = 'Female' AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS esrf12,
                (SELECT count(esr) FROM v_w_haematology_labs WHERE esr IS NOT NULL AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS esr    
            ");

        $sickling_pos = DB::select("SELECT 
                (SELECT count(sickling) FROM v_w_haematology_labs WHERE sickling = 'Positive' AND gender = 'Male' AND age < 1 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS sicklingm1,
                (SELECT count(sickling) FROM v_w_haematology_labs WHERE sickling = 'Positive' AND gender = 'Male' AND age BETWEEN 1 AND 4 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS sicklingm2,
                (SELECT count(sickling) FROM v_w_haematology_labs WHERE sickling = 'Positive' AND gender = 'Male' AND age BETWEEN 5 AND 9 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS sicklingm3,
                (SELECT count(sickling) FROM v_w_haematology_labs WHERE sickling = 'Positive' AND gender = 'Male' AND age BETWEEN 10 AND 14 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS sicklingm4,
                (SELECT count(sickling) FROM v_w_haematology_labs WHERE sickling = 'Positive' AND gender = 'Male' AND age BETWEEN 15 AND 17 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS sicklingm5,
                (SELECT count(sickling) FROM v_w_haematology_labs WHERE sickling = 'Positive' AND gender = 'Male' AND age BETWEEN 18 AND 19 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS sicklingm6,
                (SELECT count(sickling) FROM v_w_haematology_labs WHERE sickling = 'Positive' AND gender = 'Male' AND age BETWEEN 20 AND 34 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS sicklingm7,
                (SELECT count(sickling) FROM v_w_haematology_labs WHERE sickling = 'Positive' AND gender = 'Male' AND age BETWEEN 35 AND 49 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS sicklingm8,
                (SELECT count(sickling) FROM v_w_haematology_labs WHERE sickling = 'Positive' AND gender = 'Male' AND age BETWEEN 50 AND 59 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS sicklingm9,
                (SELECT count(sickling) FROM v_w_haematology_labs WHERE sickling = 'Positive' AND gender = 'Male' AND age BETWEEN 60 AND 69 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS sicklingm10,
                (SELECT count(sickling) FROM v_w_haematology_labs WHERE sickling = 'Positive' AND gender = 'Male' AND age > 69 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS sicklingm11,
                (SELECT count(sickling) FROM v_w_haematology_labs WHERE sickling = 'Positive' AND gender = 'Male' AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS sicklingm12,
                (SELECT count(sickling) FROM v_w_haematology_labs WHERE sickling = 'Positive' AND gender = 'Female' AND age < 1 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS sicklingf1,
                (SELECT count(sickling) FROM v_w_haematology_labs WHERE sickling = 'Positive' AND gender = 'Female' AND age BETWEEN 1 AND 4 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS sicklingf2,
                (SELECT count(sickling) FROM v_w_haematology_labs WHERE sickling = 'Positive' AND gender = 'Female' AND age BETWEEN 5 AND 9 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS sicklingf3,
                (SELECT count(sickling) FROM v_w_haematology_labs WHERE sickling = 'Positive' AND gender = 'Female' AND age BETWEEN 10 AND 14 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS sicklingf4,
                (SELECT count(sickling) FROM v_w_haematology_labs WHERE sickling = 'Positive' AND gender = 'Female' AND age BETWEEN 15 AND 17 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS sicklingf5,
                (SELECT count(sickling) FROM v_w_haematology_labs WHERE sickling = 'Positive' AND gender = 'Female' AND age BETWEEN 18 AND 19 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS sicklingf6,
                (SELECT count(sickling) FROM v_w_haematology_labs WHERE sickling = 'Positive' AND gender = 'Female' AND age BETWEEN 20 AND 34 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS sicklingf7,
                (SELECT count(sickling) FROM v_w_haematology_labs WHERE sickling = 'Positive' AND gender = 'Female' AND age BETWEEN 35 AND 49 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS sicklingf8,
                (SELECT count(sickling) FROM v_w_haematology_labs WHERE sickling = 'Positive' AND gender = 'Female' AND age BETWEEN 50 AND 59 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS sicklingf9,
                (SELECT count(sickling) FROM v_w_haematology_labs WHERE sickling = 'Positive' AND gender = 'Female' AND age BETWEEN 60 AND 69 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS sicklingf10,
                (SELECT count(sickling) FROM v_w_haematology_labs WHERE sickling = 'Positive' AND gender = 'Female' AND age > 69 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS sicklingf11,
                (SELECT count(sickling) FROM v_w_haematology_labs WHERE sickling = 'Positive' AND gender = 'Female' AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS sicklingf12,
                (SELECT count(sickling) FROM v_w_haematology_labs WHERE sickling = 'Positive' AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS sickling
            ");

        $sickling_neg = DB::select("SELECT 
                (SELECT count(sickling) FROM v_w_haematology_labs WHERE sickling = 'Negative' AND gender = 'Male' AND age < 1 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS sicklingm1,
                (SELECT count(sickling) FROM v_w_haematology_labs WHERE sickling = 'Negative' AND gender = 'Male' AND age BETWEEN 1 AND 4 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS sicklingm2,
                (SELECT count(sickling) FROM v_w_haematology_labs WHERE sickling = 'Negative' AND gender = 'Male' AND age BETWEEN 5 AND 9 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS sicklingm3,
                (SELECT count(sickling) FROM v_w_haematology_labs WHERE sickling = 'Negative' AND gender = 'Male' AND age BETWEEN 10 AND 14 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS sicklingm4,
                (SELECT count(sickling) FROM v_w_haematology_labs WHERE sickling = 'Negative' AND gender = 'Male' AND age BETWEEN 15 AND 17 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS sicklingm5,
                (SELECT count(sickling) FROM v_w_haematology_labs WHERE sickling = 'Negative' AND gender = 'Male' AND age BETWEEN 18 AND 19 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS sicklingm6,
                (SELECT count(sickling) FROM v_w_haematology_labs WHERE sickling = 'Negative' AND gender = 'Male' AND age BETWEEN 20 AND 34 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS sicklingm7,
                (SELECT count(sickling) FROM v_w_haematology_labs WHERE sickling = 'Negative' AND gender = 'Male' AND age BETWEEN 35 AND 49 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS sicklingm8,
                (SELECT count(sickling) FROM v_w_haematology_labs WHERE sickling = 'Negative' AND gender = 'Male' AND age BETWEEN 50 AND 59 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS sicklingm9,
                (SELECT count(sickling) FROM v_w_haematology_labs WHERE sickling = 'Negative' AND gender = 'Male' AND age BETWEEN 60 AND 69 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS sicklingm10,
                (SELECT count(sickling) FROM v_w_haematology_labs WHERE sickling = 'Negative' AND gender = 'Male' AND age > 69 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS sicklingm11,
                (SELECT count(sickling) FROM v_w_haematology_labs WHERE sickling = 'Negative' AND gender = 'Male' AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS sicklingm12,
                (SELECT count(sickling) FROM v_w_haematology_labs WHERE sickling = 'Negative' AND gender = 'Female' AND age < 1 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS sicklingf1,
                (SELECT count(sickling) FROM v_w_haematology_labs WHERE sickling = 'Negative' AND gender = 'Female' AND age BETWEEN 1 AND 4 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS sicklingf2,
                (SELECT count(sickling) FROM v_w_haematology_labs WHERE sickling = 'Negative' AND gender = 'Female' AND age BETWEEN 5 AND 9 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS sicklingf3,
                (SELECT count(sickling) FROM v_w_haematology_labs WHERE sickling = 'Negative' AND gender = 'Female' AND age BETWEEN 10 AND 14 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS sicklingf4,
                (SELECT count(sickling) FROM v_w_haematology_labs WHERE sickling = 'Negative' AND gender = 'Female' AND age BETWEEN 15 AND 17 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS sicklingf5,
                (SELECT count(sickling) FROM v_w_haematology_labs WHERE sickling = 'Negative' AND gender = 'Female' AND age BETWEEN 18 AND 19 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS sicklingf6,
                (SELECT count(sickling) FROM v_w_haematology_labs WHERE sickling = 'Negative' AND gender = 'Female' AND age BETWEEN 20 AND 34 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS sicklingf7,
                (SELECT count(sickling) FROM v_w_haematology_labs WHERE sickling = 'Negative' AND gender = 'Female' AND age BETWEEN 35 AND 49 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS sicklingf8,
                (SELECT count(sickling) FROM v_w_haematology_labs WHERE sickling = 'Negative' AND gender = 'Female' AND age BETWEEN 50 AND 59 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS sicklingf9,
                (SELECT count(sickling) FROM v_w_haematology_labs WHERE sickling = 'Negative' AND gender = 'Female' AND age BETWEEN 60 AND 69 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS sicklingf10,
                (SELECT count(sickling) FROM v_w_haematology_labs WHERE sickling = 'Negative' AND gender = 'Female' AND age > 69 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS sicklingf11,
                (SELECT count(sickling) FROM v_w_haematology_labs WHERE sickling = 'Negative' AND gender = 'Female' AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS sicklingf12,
                (SELECT count(sickling) FROM v_w_haematology_labs WHERE sickling = 'Negative' AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS sickling
            ");

        $sickling_hb = DB::select("SELECT 
                (SELECT count(sickling_hb) FROM v_w_haematology_labs WHERE sickling_hb IS NOT NULL AND gender = 'Male' AND age < 1 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS sickling_hbm1,
                (SELECT count(sickling_hb) FROM v_w_haematology_labs WHERE sickling_hb IS NOT NULL AND gender = 'Male' AND age BETWEEN 1 AND 4 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS sickling_hbm2,
                (SELECT count(sickling_hb) FROM v_w_haematology_labs WHERE sickling_hb IS NOT NULL AND gender = 'Male' AND age BETWEEN 5 AND 9 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS sickling_hbm3,
                (SELECT count(sickling_hb) FROM v_w_haematology_labs WHERE sickling_hb IS NOT NULL AND gender = 'Male' AND age BETWEEN 10 AND 14 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS sickling_hbm4,
                (SELECT count(sickling_hb) FROM v_w_haematology_labs WHERE sickling_hb IS NOT NULL AND gender = 'Male' AND age BETWEEN 15 AND 17 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS sickling_hbm5,
                (SELECT count(sickling_hb) FROM v_w_haematology_labs WHERE sickling_hb IS NOT NULL AND gender = 'Male' AND age BETWEEN 18 AND 19 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS sickling_hbm6,
                (SELECT count(sickling_hb) FROM v_w_haematology_labs WHERE sickling_hb IS NOT NULL AND gender = 'Male' AND age BETWEEN 20 AND 34 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS sickling_hbm7,
                (SELECT count(sickling_hb) FROM v_w_haematology_labs WHERE sickling_hb IS NOT NULL AND gender = 'Male' AND age BETWEEN 35 AND 49 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS sickling_hbm8,
                (SELECT count(sickling_hb) FROM v_w_haematology_labs WHERE sickling_hb IS NOT NULL AND gender = 'Male' AND age BETWEEN 50 AND 59 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS sickling_hbm9,
                (SELECT count(sickling_hb) FROM v_w_haematology_labs WHERE sickling_hb IS NOT NULL AND gender = 'Male' AND age BETWEEN 60 AND 69 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS sickling_hbm10,
                (SELECT count(sickling_hb) FROM v_w_haematology_labs WHERE sickling_hb IS NOT NULL AND gender = 'Male' AND age > 69 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS sickling_hbm11,
                (SELECT count(sickling_hb) FROM v_w_haematology_labs WHERE sickling_hb IS NOT NULL AND gender = 'Male' AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS sickling_hbm12,
                (SELECT count(sickling_hb) FROM v_w_haematology_labs WHERE sickling_hb IS NOT NULL AND gender = 'Female' AND age < 1 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS sickling_hbf1,
                (SELECT count(sickling_hb) FROM v_w_haematology_labs WHERE sickling_hb IS NOT NULL AND gender = 'Female' AND age BETWEEN 1 AND 4 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS sickling_hbf2,
                (SELECT count(sickling_hb) FROM v_w_haematology_labs WHERE sickling_hb IS NOT NULL AND gender = 'Female' AND age BETWEEN 5 AND 9 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS sickling_hbf3,
                (SELECT count(sickling_hb) FROM v_w_haematology_labs WHERE sickling_hb IS NOT NULL AND gender = 'Female' AND age BETWEEN 10 AND 14 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS sickling_hbf4,
                (SELECT count(sickling_hb) FROM v_w_haematology_labs WHERE sickling_hb IS NOT NULL AND gender = 'Female' AND age BETWEEN 15 AND 17 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS sickling_hbf5,
                (SELECT count(sickling_hb) FROM v_w_haematology_labs WHERE sickling_hb IS NOT NULL AND gender = 'Female' AND age BETWEEN 18 AND 19 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS sickling_hbf6,
                (SELECT count(sickling_hb) FROM v_w_haematology_labs WHERE sickling_hb IS NOT NULL AND gender = 'Female' AND age BETWEEN 20 AND 34 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS sickling_hbf7,
                (SELECT count(sickling_hb) FROM v_w_haematology_labs WHERE sickling_hb IS NOT NULL AND gender = 'Female' AND age BETWEEN 35 AND 49 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS sickling_hbf8,
                (SELECT count(sickling_hb) FROM v_w_haematology_labs WHERE sickling_hb IS NOT NULL AND gender = 'Female' AND age BETWEEN 50 AND 59 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS sickling_hbf9,
                (SELECT count(sickling_hb) FROM v_w_haematology_labs WHERE sickling_hb IS NOT NULL AND gender = 'Female' AND age BETWEEN 60 AND 69 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS sickling_hbf10,
                (SELECT count(sickling_hb) FROM v_w_haematology_labs WHERE sickling_hb IS NOT NULL AND gender = 'Female' AND age > 69 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS sickling_hbf11,
                (SELECT count(sickling_hb) FROM v_w_haematology_labs WHERE sickling_hb IS NOT NULL AND gender = 'Female' AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS sickling_hbf12,
                (SELECT count(sickling_hb) FROM v_w_haematology_labs WHERE sickling_hb IS NOT NULL AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS sickling_hb
            ");

        $widal_o = DB::select("SELECT 
                (SELECT count(widal_o) FROM v_w_haematology_labs WHERE widal_o IS NOT NULL AND gender = 'Male' AND age < 1 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS widal_om1,
                (SELECT count(widal_o) FROM v_w_haematology_labs WHERE widal_o IS NOT NULL AND gender = 'Male' AND age BETWEEN 1 AND 4 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS widal_om2,
                (SELECT count(widal_o) FROM v_w_haematology_labs WHERE widal_o IS NOT NULL AND gender = 'Male' AND age BETWEEN 5 AND 9 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS widal_om3,
                (SELECT count(widal_o) FROM v_w_haematology_labs WHERE widal_o IS NOT NULL AND gender = 'Male' AND age BETWEEN 10 AND 14 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS widal_om4,
                (SELECT count(widal_o) FROM v_w_haematology_labs WHERE widal_o IS NOT NULL AND gender = 'Male' AND age BETWEEN 15 AND 17 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS widal_om5,
                (SELECT count(widal_o) FROM v_w_haematology_labs WHERE widal_o IS NOT NULL AND gender = 'Male' AND age BETWEEN 18 AND 19 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS widal_om6,
                (SELECT count(widal_o) FROM v_w_haematology_labs WHERE widal_o IS NOT NULL AND gender = 'Male' AND age BETWEEN 20 AND 34 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS widal_om7,
                (SELECT count(widal_o) FROM v_w_haematology_labs WHERE widal_o IS NOT NULL AND gender = 'Male' AND age BETWEEN 35 AND 49 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS widal_om8,
                (SELECT count(widal_o) FROM v_w_haematology_labs WHERE widal_o IS NOT NULL AND gender = 'Male' AND age BETWEEN 50 AND 59 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS widal_om9,
                (SELECT count(widal_o) FROM v_w_haematology_labs WHERE widal_o IS NOT NULL AND gender = 'Male' AND age BETWEEN 60 AND 69 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS widal_om10,
                (SELECT count(widal_o) FROM v_w_haematology_labs WHERE widal_o IS NOT NULL AND gender = 'Male' AND age > 69 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS widal_om11,
                (SELECT count(widal_o) FROM v_w_haematology_labs WHERE widal_o IS NOT NULL AND gender = 'Male' AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS widal_om12,
                (SELECT count(widal_o) FROM v_w_haematology_labs WHERE widal_o IS NOT NULL AND gender = 'Female' AND age < 1 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS widal_of1,
                (SELECT count(widal_o) FROM v_w_haematology_labs WHERE widal_o IS NOT NULL AND gender = 'Female' AND age BETWEEN 1 AND 4 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS widal_of2,
                (SELECT count(widal_o) FROM v_w_haematology_labs WHERE widal_o IS NOT NULL AND gender = 'Female' AND age BETWEEN 5 AND 9 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS widal_of3,
                (SELECT count(widal_o) FROM v_w_haematology_labs WHERE widal_o IS NOT NULL AND gender = 'Female' AND age BETWEEN 10 AND 14 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS widal_of4,
                (SELECT count(widal_o) FROM v_w_haematology_labs WHERE widal_o IS NOT NULL AND gender = 'Female' AND age BETWEEN 15 AND 17 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS widal_of5,
                (SELECT count(widal_o) FROM v_w_haematology_labs WHERE widal_o IS NOT NULL AND gender = 'Female' AND age BETWEEN 18 AND 19 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS widal_of6,
                (SELECT count(widal_o) FROM v_w_haematology_labs WHERE widal_o IS NOT NULL AND gender = 'Female' AND age BETWEEN 20 AND 34 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS widal_of7,
                (SELECT count(widal_o) FROM v_w_haematology_labs WHERE widal_o IS NOT NULL AND gender = 'Female' AND age BETWEEN 35 AND 49 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS widal_of8,
                (SELECT count(widal_o) FROM v_w_haematology_labs WHERE widal_o IS NOT NULL AND gender = 'Female' AND age BETWEEN 50 AND 59 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS widal_of9,
                (SELECT count(widal_o) FROM v_w_haematology_labs WHERE widal_o IS NOT NULL AND gender = 'Female' AND age BETWEEN 60 AND 69 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS widal_of10,
                (SELECT count(widal_o) FROM v_w_haematology_labs WHERE widal_o IS NOT NULL AND gender = 'Female' AND age > 69 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS widal_of11,
                (SELECT count(widal_o) FROM v_w_haematology_labs WHERE widal_o IS NOT NULL AND gender = 'Female' AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS widal_of12,
                (SELECT count(widal_o) FROM v_w_haematology_labs WHERE widal_o IS NOT NULL AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS widal_o
            ");

        $widal_h = DB::select("SELECT 
                (SELECT count(widal_h) FROM v_w_haematology_labs WHERE widal_h IS NOT NULL AND gender = 'Male' AND age < 1 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS widal_hm1,
                (SELECT count(widal_h) FROM v_w_haematology_labs WHERE widal_h IS NOT NULL AND gender = 'Male' AND age BETWEEN 1 AND 4 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS widal_hm2,
                (SELECT count(widal_h) FROM v_w_haematology_labs WHERE widal_h IS NOT NULL AND gender = 'Male' AND age BETWEEN 5 AND 9 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS widal_hm3,
                (SELECT count(widal_h) FROM v_w_haematology_labs WHERE widal_h IS NOT NULL AND gender = 'Male' AND age BETWEEN 10 AND 14 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS widal_hm4,
                (SELECT count(widal_h) FROM v_w_haematology_labs WHERE widal_h IS NOT NULL AND gender = 'Male' AND age BETWEEN 15 AND 17 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS widal_hm5,
                (SELECT count(widal_h) FROM v_w_haematology_labs WHERE widal_h IS NOT NULL AND gender = 'Male' AND age BETWEEN 18 AND 19 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS widal_hm6,
                (SELECT count(widal_h) FROM v_w_haematology_labs WHERE widal_h IS NOT NULL AND gender = 'Male' AND age BETWEEN 20 AND 34 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS widal_hm7,
                (SELECT count(widal_h) FROM v_w_haematology_labs WHERE widal_h IS NOT NULL AND gender = 'Male' AND age BETWEEN 35 AND 49 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS widal_hm8,
                (SELECT count(widal_h) FROM v_w_haematology_labs WHERE widal_h IS NOT NULL AND gender = 'Male' AND age BETWEEN 50 AND 59 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS widal_hm9,
                (SELECT count(widal_h) FROM v_w_haematology_labs WHERE widal_h IS NOT NULL AND gender = 'Male' AND age BETWEEN 60 AND 69 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS widal_hm10,
                (SELECT count(widal_h) FROM v_w_haematology_labs WHERE widal_h IS NOT NULL AND gender = 'Male' AND age > 69 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS widal_hm11,
                (SELECT count(widal_h) FROM v_w_haematology_labs WHERE widal_h IS NOT NULL AND gender = 'Male' AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS widal_hm12,
                (SELECT count(widal_h) FROM v_w_haematology_labs WHERE widal_h IS NOT NULL AND gender = 'Female' AND age < 1 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS widal_hf1,
                (SELECT count(widal_h) FROM v_w_haematology_labs WHERE widal_h IS NOT NULL AND gender = 'Female' AND age BETWEEN 1 AND 4 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS widal_hf2,
                (SELECT count(widal_h) FROM v_w_haematology_labs WHERE widal_h IS NOT NULL AND gender = 'Female' AND age BETWEEN 5 AND 9 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS widal_hf3,
                (SELECT count(widal_h) FROM v_w_haematology_labs WHERE widal_h IS NOT NULL AND gender = 'Female' AND age BETWEEN 10 AND 14 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS widal_hf4,
                (SELECT count(widal_h) FROM v_w_haematology_labs WHERE widal_h IS NOT NULL AND gender = 'Female' AND age BETWEEN 15 AND 17 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS widal_hf5,
                (SELECT count(widal_h) FROM v_w_haematology_labs WHERE widal_h IS NOT NULL AND gender = 'Female' AND age BETWEEN 18 AND 19 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS widal_hf6,
                (SELECT count(widal_h) FROM v_w_haematology_labs WHERE widal_h IS NOT NULL AND gender = 'Female' AND age BETWEEN 20 AND 34 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS widal_hf7,
                (SELECT count(widal_h) FROM v_w_haematology_labs WHERE widal_h IS NOT NULL AND gender = 'Female' AND age BETWEEN 35 AND 49 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS widal_hf8,
                (SELECT count(widal_h) FROM v_w_haematology_labs WHERE widal_h IS NOT NULL AND gender = 'Female' AND age BETWEEN 50 AND 59 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS widal_hf9,
                (SELECT count(widal_h) FROM v_w_haematology_labs WHERE widal_h IS NOT NULL AND gender = 'Female' AND age BETWEEN 60 AND 69 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS widal_hf10,
                (SELECT count(widal_h) FROM v_w_haematology_labs WHERE widal_h IS NOT NULL AND gender = 'Female' AND age > 69 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS widal_hf11,
                (SELECT count(widal_h) FROM v_w_haematology_labs WHERE widal_h IS NOT NULL AND gender = 'Female' AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS widal_hf12,
                (SELECT count(widal_h) FROM v_w_haematology_labs WHERE widal_h IS NOT NULL AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS widal_h
            ");

        $urinalysis = DB::select("SELECT 
                (SELECT count(color) FROM v_w_haematology_labs WHERE color IS NOT NULL AND gender = 'Male' AND age < 1 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS colorm1,
                (SELECT count(color) FROM v_w_haematology_labs WHERE color IS NOT NULL AND gender = 'Male' AND age BETWEEN 1 AND 4 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS colorm2,
                (SELECT count(color) FROM v_w_haematology_labs WHERE color IS NOT NULL AND gender = 'Male' AND age BETWEEN 5 AND 9 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS colorm3,
                (SELECT count(color) FROM v_w_haematology_labs WHERE color IS NOT NULL AND gender = 'Male' AND age BETWEEN 10 AND 14 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS colorm4,
                (SELECT count(color) FROM v_w_haematology_labs WHERE color IS NOT NULL AND gender = 'Male' AND age BETWEEN 15 AND 17 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS colorm5,
                (SELECT count(color) FROM v_w_haematology_labs WHERE color IS NOT NULL AND gender = 'Male' AND age BETWEEN 18 AND 19 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS colorm6,
                (SELECT count(color) FROM v_w_haematology_labs WHERE color IS NOT NULL AND gender = 'Male' AND age BETWEEN 20 AND 34 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS colorm7,
                (SELECT count(color) FROM v_w_haematology_labs WHERE color IS NOT NULL AND gender = 'Male' AND age BETWEEN 35 AND 49 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS colorm8,
                (SELECT count(color) FROM v_w_haematology_labs WHERE color IS NOT NULL AND gender = 'Male' AND age BETWEEN 50 AND 59 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS colorm9,
                (SELECT count(color) FROM v_w_haematology_labs WHERE color IS NOT NULL AND gender = 'Male' AND age BETWEEN 60 AND 69 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS colorm10,
                (SELECT count(color) FROM v_w_haematology_labs WHERE color IS NOT NULL AND gender = 'Male' AND age > 69 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS colorm11,
                (SELECT count(color) FROM v_w_haematology_labs WHERE color IS NOT NULL AND gender = 'Male' AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS colorm12,
                (SELECT count(color) FROM v_w_haematology_labs WHERE color IS NOT NULL AND gender = 'Female' AND age < 1 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS colorf1,
                (SELECT count(color) FROM v_w_haematology_labs WHERE color IS NOT NULL AND gender = 'Female' AND age BETWEEN 1 AND 4 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS colorf2,
                (SELECT count(color) FROM v_w_haematology_labs WHERE color IS NOT NULL AND gender = 'Female' AND age BETWEEN 5 AND 9 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS colorf3,
                (SELECT count(color) FROM v_w_haematology_labs WHERE color IS NOT NULL AND gender = 'Female' AND age BETWEEN 10 AND 14 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS colorf4,
                (SELECT count(color) FROM v_w_haematology_labs WHERE color IS NOT NULL AND gender = 'Female' AND age BETWEEN 15 AND 17 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS colorf5,
                (SELECT count(color) FROM v_w_haematology_labs WHERE color IS NOT NULL AND gender = 'Female' AND age BETWEEN 18 AND 19 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS colorf6,
                (SELECT count(color) FROM v_w_haematology_labs WHERE color IS NOT NULL AND gender = 'Female' AND age BETWEEN 20 AND 34 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS colorf7,
                (SELECT count(color) FROM v_w_haematology_labs WHERE color IS NOT NULL AND gender = 'Female' AND age BETWEEN 35 AND 49 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS colorf8,
                (SELECT count(color) FROM v_w_haematology_labs WHERE color IS NOT NULL AND gender = 'Female' AND age BETWEEN 50 AND 59 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS colorf9,
                (SELECT count(color) FROM v_w_haematology_labs WHERE color IS NOT NULL AND gender = 'Female' AND age BETWEEN 60 AND 69 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS colorf10,
                (SELECT count(color) FROM v_w_haematology_labs WHERE color IS NOT NULL AND gender = 'Female' AND age > 69 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS colorf11,
                (SELECT count(color) FROM v_w_haematology_labs WHERE color IS NOT NULL AND gender = 'Female' AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS colorf12,
                (SELECT count(color) FROM v_w_haematology_labs WHERE color IS NOT NULL AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS color
            ");

        $stool = DB::select("SELECT 
                (SELECT count(macro) FROM v_w_haematology_labs WHERE macro IS NOT NULL AND gender = 'Male' AND age < 1 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS macrom1,
                (SELECT count(macro) FROM v_w_haematology_labs WHERE macro IS NOT NULL AND gender = 'Male' AND age BETWEEN 1 AND 4 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS macrom2,
                (SELECT count(macro) FROM v_w_haematology_labs WHERE macro IS NOT NULL AND gender = 'Male' AND age BETWEEN 5 AND 9 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS macrom3,
                (SELECT count(macro) FROM v_w_haematology_labs WHERE macro IS NOT NULL AND gender = 'Male' AND age BETWEEN 10 AND 14 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS macrom4,
                (SELECT count(macro) FROM v_w_haematology_labs WHERE macro IS NOT NULL AND gender = 'Male' AND age BETWEEN 15 AND 17 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS macrom5,
                (SELECT count(macro) FROM v_w_haematology_labs WHERE macro IS NOT NULL AND gender = 'Male' AND age BETWEEN 18 AND 19 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS macrom6,
                (SELECT count(macro) FROM v_w_haematology_labs WHERE macro IS NOT NULL AND gender = 'Male' AND age BETWEEN 20 AND 34 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS macrom7,
                (SELECT count(macro) FROM v_w_haematology_labs WHERE macro IS NOT NULL AND gender = 'Male' AND age BETWEEN 35 AND 49 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS macrom8,
                (SELECT count(macro) FROM v_w_haematology_labs WHERE macro IS NOT NULL AND gender = 'Male' AND age BETWEEN 50 AND 59 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS macrom9,
                (SELECT count(macro) FROM v_w_haematology_labs WHERE macro IS NOT NULL AND gender = 'Male' AND age BETWEEN 60 AND 69 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS macrom10,
                (SELECT count(macro) FROM v_w_haematology_labs WHERE macro IS NOT NULL AND gender = 'Male' AND age > 69 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS macrom11,
                (SELECT count(macro) FROM v_w_haematology_labs WHERE macro IS NOT NULL AND gender = 'Male' AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS macrom12,
                (SELECT count(macro) FROM v_w_haematology_labs WHERE macro IS NOT NULL AND gender = 'Female' AND age < 1 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS macrof1,
                (SELECT count(macro) FROM v_w_haematology_labs WHERE macro IS NOT NULL AND gender = 'Female' AND age BETWEEN 1 AND 4 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS macrof2,
                (SELECT count(macro) FROM v_w_haematology_labs WHERE macro IS NOT NULL AND gender = 'Female' AND age BETWEEN 5 AND 9 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS macrof3,
                (SELECT count(macro) FROM v_w_haematology_labs WHERE macro IS NOT NULL AND gender = 'Female' AND age BETWEEN 10 AND 14 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS macrof4,
                (SELECT count(macro) FROM v_w_haematology_labs WHERE macro IS NOT NULL AND gender = 'Female' AND age BETWEEN 15 AND 17 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS macrof5,
                (SELECT count(macro) FROM v_w_haematology_labs WHERE macro IS NOT NULL AND gender = 'Female' AND age BETWEEN 18 AND 19 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS macrof6,
                (SELECT count(macro) FROM v_w_haematology_labs WHERE macro IS NOT NULL AND gender = 'Female' AND age BETWEEN 20 AND 34 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS macrof7,
                (SELECT count(macro) FROM v_w_haematology_labs WHERE macro IS NOT NULL AND gender = 'Female' AND age BETWEEN 35 AND 49 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS macrof8,
                (SELECT count(macro) FROM v_w_haematology_labs WHERE macro IS NOT NULL AND gender = 'Female' AND age BETWEEN 50 AND 59 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS macrof9,
                (SELECT count(macro) FROM v_w_haematology_labs WHERE macro IS NOT NULL AND gender = 'Female' AND age BETWEEN 60 AND 69 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS macrof10,
                (SELECT count(macro) FROM v_w_haematology_labs WHERE macro IS NOT NULL AND gender = 'Female' AND age > 69 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS macrof11,
                (SELECT count(macro) FROM v_w_haematology_labs WHERE macro IS NOT NULL AND gender = 'Female' AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS macrof12,
                (SELECT count(macro) FROM v_w_haematology_labs WHERE macro IS NOT NULL AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS macro
            ");

        $fbc = DB::select("SELECT 
                (SELECT count(wbc) FROM v_w_haematology_labs WHERE wbc IS NOT NULL AND gender = 'Male' AND age < 1 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS wbcm1,
                (SELECT count(wbc) FROM v_w_haematology_labs WHERE wbc IS NOT NULL AND gender = 'Male' AND age BETWEEN 1 AND 4 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS wbcm2,
                (SELECT count(wbc) FROM v_w_haematology_labs WHERE wbc IS NOT NULL AND gender = 'Male' AND age BETWEEN 5 AND 9 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS wbcm3,
                (SELECT count(wbc) FROM v_w_haematology_labs WHERE wbc IS NOT NULL AND gender = 'Male' AND age BETWEEN 10 AND 14 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS wbcm4,
                (SELECT count(wbc) FROM v_w_haematology_labs WHERE wbc IS NOT NULL AND gender = 'Male' AND age BETWEEN 15 AND 17 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS wbcm5,
                (SELECT count(wbc) FROM v_w_haematology_labs WHERE wbc IS NOT NULL AND gender = 'Male' AND age BETWEEN 18 AND 19 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS wbcm6,
                (SELECT count(wbc) FROM v_w_haematology_labs WHERE wbc IS NOT NULL AND gender = 'Male' AND age BETWEEN 20 AND 34 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS wbcm7,
                (SELECT count(wbc) FROM v_w_haematology_labs WHERE wbc IS NOT NULL AND gender = 'Male' AND age BETWEEN 35 AND 49 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS wbcm8,
                (SELECT count(wbc) FROM v_w_haematology_labs WHERE wbc IS NOT NULL AND gender = 'Male' AND age BETWEEN 50 AND 59 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS wbcm9,
                (SELECT count(wbc) FROM v_w_haematology_labs WHERE wbc IS NOT NULL AND gender = 'Male' AND age BETWEEN 60 AND 69 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS wbcm10,
                (SELECT count(wbc) FROM v_w_haematology_labs WHERE wbc IS NOT NULL AND gender = 'Male' AND age > 69 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS wbcm11,
                (SELECT count(wbc) FROM v_w_haematology_labs WHERE wbc IS NOT NULL AND gender = 'Male' AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS wbcm12,
                (SELECT count(wbc) FROM v_w_haematology_labs WHERE wbc IS NOT NULL AND gender = 'Female' AND age < 1 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS wbcf1,
                (SELECT count(wbc) FROM v_w_haematology_labs WHERE wbc IS NOT NULL AND gender = 'Female' AND age BETWEEN 1 AND 4 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS wbcf2,
                (SELECT count(wbc) FROM v_w_haematology_labs WHERE wbc IS NOT NULL AND gender = 'Female' AND age BETWEEN 5 AND 9 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS wbcf3,
                (SELECT count(wbc) FROM v_w_haematology_labs WHERE wbc IS NOT NULL AND gender = 'Female' AND age BETWEEN 10 AND 14 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS wbcf4,
                (SELECT count(wbc) FROM v_w_haematology_labs WHERE wbc IS NOT NULL AND gender = 'Female' AND age BETWEEN 15 AND 17 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS wbcf5,
                (SELECT count(wbc) FROM v_w_haematology_labs WHERE wbc IS NOT NULL AND gender = 'Female' AND age BETWEEN 18 AND 19 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS wbcf6,
                (SELECT count(wbc) FROM v_w_haematology_labs WHERE wbc IS NOT NULL AND gender = 'Female' AND age BETWEEN 20 AND 34 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS wbcf7,
                (SELECT count(wbc) FROM v_w_haematology_labs WHERE wbc IS NOT NULL AND gender = 'Female' AND age BETWEEN 35 AND 49 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS wbcf8,
                (SELECT count(wbc) FROM v_w_haematology_labs WHERE wbc IS NOT NULL AND gender = 'Female' AND age BETWEEN 50 AND 59 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS wbcf9,
                (SELECT count(wbc) FROM v_w_haematology_labs WHERE wbc IS NOT NULL AND gender = 'Female' AND age BETWEEN 60 AND 69 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS wbcf10,
                (SELECT count(wbc) FROM v_w_haematology_labs WHERE wbc IS NOT NULL AND gender = 'Female' AND age > 69 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS wbcf11,
                (SELECT count(wbc) FROM v_w_haematology_labs WHERE wbc IS NOT NULL AND gender = 'Female' AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS wbcf12,
                (SELECT count(wbc) FROM v_w_haematology_labs WHERE wbc IS NOT NULL AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS wbc
            ");

        $hiv = DB::select("SELECT 
                (SELECT count(lab_info_id) FROM v_w_haematology_labs WHERE (first_resp IS NOT NULL OR ora_quick IS NOT NULL) AND gender = 'Male' AND age < 1 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS first_respm1,
                (SELECT count(lab_info_id) FROM v_w_haematology_labs WHERE (first_resp IS NOT NULL OR ora_quick IS NOT NULL) AND gender = 'Male' AND age BETWEEN 1 AND 4 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS first_respm2,
                (SELECT count(lab_info_id) FROM v_w_haematology_labs WHERE (first_resp IS NOT NULL OR ora_quick IS NOT NULL) AND gender = 'Male' AND age BETWEEN 5 AND 9 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS first_respm3,
                (SELECT count(lab_info_id) FROM v_w_haematology_labs WHERE (first_resp IS NOT NULL OR ora_quick IS NOT NULL) AND gender = 'Male' AND age BETWEEN 10 AND 14 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS first_respm4,
                (SELECT count(lab_info_id) FROM v_w_haematology_labs WHERE (first_resp IS NOT NULL OR ora_quick IS NOT NULL) AND gender = 'Male' AND age BETWEEN 15 AND 17 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS first_respm5,
                (SELECT count(lab_info_id) FROM v_w_haematology_labs WHERE (first_resp IS NOT NULL OR ora_quick IS NOT NULL) AND gender = 'Male' AND age BETWEEN 18 AND 19 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS first_respm6,
                (SELECT count(lab_info_id) FROM v_w_haematology_labs WHERE (first_resp IS NOT NULL OR ora_quick IS NOT NULL) AND gender = 'Male' AND age BETWEEN 20 AND 34 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS first_respm7,
                (SELECT count(lab_info_id) FROM v_w_haematology_labs WHERE (first_resp IS NOT NULL OR ora_quick IS NOT NULL) AND gender = 'Male' AND age BETWEEN 35 AND 49 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS first_respm8,
                (SELECT count(lab_info_id) FROM v_w_haematology_labs WHERE (first_resp IS NOT NULL OR ora_quick IS NOT NULL) AND gender = 'Male' AND age BETWEEN 50 AND 59 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS first_respm9,
                (SELECT count(lab_info_id) FROM v_w_haematology_labs WHERE (first_resp IS NOT NULL OR ora_quick IS NOT NULL) AND gender = 'Male' AND age BETWEEN 60 AND 69 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS first_respm10,
                (SELECT count(lab_info_id) FROM v_w_haematology_labs WHERE (first_resp IS NOT NULL OR ora_quick IS NOT NULL) AND gender = 'Male' AND age > 69 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS first_respm11,
                (SELECT count(lab_info_id) FROM v_w_haematology_labs WHERE (first_resp IS NOT NULL OR ora_quick IS NOT NULL) AND gender = 'Male' AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS first_respm12,
                (SELECT count(lab_info_id) FROM v_w_haematology_labs WHERE (first_resp IS NOT NULL OR ora_quick IS NOT NULL) AND gender = 'Female' AND age < 1 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS first_respf1,
                (SELECT count(lab_info_id) FROM v_w_haematology_labs WHERE (first_resp IS NOT NULL OR ora_quick IS NOT NULL) AND gender = 'Female' AND age BETWEEN 1 AND 4 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS first_respf2,
                (SELECT count(lab_info_id) FROM v_w_haematology_labs WHERE (first_resp IS NOT NULL OR ora_quick IS NOT NULL) AND gender = 'Female' AND age BETWEEN 5 AND 9 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS first_respf3,
                (SELECT count(lab_info_id) FROM v_w_haematology_labs WHERE (first_resp IS NOT NULL OR ora_quick IS NOT NULL) AND gender = 'Female' AND age BETWEEN 10 AND 14 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS first_respf4,
                (SELECT count(lab_info_id) FROM v_w_haematology_labs WHERE (first_resp IS NOT NULL OR ora_quick IS NOT NULL) AND gender = 'Female' AND age BETWEEN 15 AND 17 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS first_respf5,
                (SELECT count(lab_info_id) FROM v_w_haematology_labs WHERE (first_resp IS NOT NULL OR ora_quick IS NOT NULL) AND gender = 'Female' AND age BETWEEN 18 AND 19 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS first_respf6,
                (SELECT count(lab_info_id) FROM v_w_haematology_labs WHERE (first_resp IS NOT NULL OR ora_quick IS NOT NULL) AND gender = 'Female' AND age BETWEEN 20 AND 34 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS first_respf7,
                (SELECT count(lab_info_id) FROM v_w_haematology_labs WHERE (first_resp IS NOT NULL OR ora_quick IS NOT NULL) AND gender = 'Female' AND age BETWEEN 35 AND 49 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS first_respf8,
                (SELECT count(lab_info_id) FROM v_w_haematology_labs WHERE (first_resp IS NOT NULL OR ora_quick IS NOT NULL) AND gender = 'Female' AND age BETWEEN 50 AND 59 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS first_respf9,
                (SELECT count(lab_info_id) FROM v_w_haematology_labs WHERE (first_resp IS NOT NULL OR ora_quick IS NOT NULL) AND gender = 'Female' AND age BETWEEN 60 AND 69 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS first_respf10,
                (SELECT count(lab_info_id) FROM v_w_haematology_labs WHERE (first_resp IS NOT NULL OR ora_quick IS NOT NULL) AND gender = 'Female' AND age > 69 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS first_respf11,
                (SELECT count(lab_info_id) FROM v_w_haematology_labs WHERE (first_resp IS NOT NULL OR ora_quick IS NOT NULL) AND gender = 'Female' AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS first_respf12,
                (SELECT count(lab_info_id) FROM v_w_haematology_labs WHERE (first_resp IS NOT NULL OR ora_quick IS NOT NULL) AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS first_resp
            ");

        $hiv_pos = DB::select("SELECT 
                (SELECT count(lab_info_id) FROM v_w_haematology_labs WHERE (sd_bioline = 'Positive' OR hiv_final = 'Positive') AND gender = 'Male' AND age < 1 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS sd_biolinem1,
                (SELECT count(lab_info_id) FROM v_w_haematology_labs WHERE (sd_bioline = 'Positive' OR hiv_final = 'Positive') AND gender = 'Male' AND age BETWEEN 1 AND 4 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS sd_biolinem2,
                (SELECT count(lab_info_id) FROM v_w_haematology_labs WHERE (sd_bioline = 'Positive' OR hiv_final = 'Positive') AND gender = 'Male' AND age BETWEEN 5 AND 9 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS sd_biolinem3,
                (SELECT count(lab_info_id) FROM v_w_haematology_labs WHERE (sd_bioline = 'Positive' OR hiv_final = 'Positive') AND gender = 'Male' AND age BETWEEN 10 AND 14 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS sd_biolinem4,
                (SELECT count(lab_info_id) FROM v_w_haematology_labs WHERE (sd_bioline = 'Positive' OR hiv_final = 'Positive') AND gender = 'Male' AND age BETWEEN 15 AND 17 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS sd_biolinem5,
                (SELECT count(lab_info_id) FROM v_w_haematology_labs WHERE (sd_bioline = 'Positive' OR hiv_final = 'Positive') AND gender = 'Male' AND age BETWEEN 18 AND 19 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS sd_biolinem6,
                (SELECT count(lab_info_id) FROM v_w_haematology_labs WHERE (sd_bioline = 'Positive' OR hiv_final = 'Positive') AND gender = 'Male' AND age BETWEEN 20 AND 34 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS sd_biolinem7,
                (SELECT count(lab_info_id) FROM v_w_haematology_labs WHERE (sd_bioline = 'Positive' OR hiv_final = 'Positive') AND gender = 'Male' AND age BETWEEN 35 AND 49 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS sd_biolinem8,
                (SELECT count(lab_info_id) FROM v_w_haematology_labs WHERE (sd_bioline = 'Positive' OR hiv_final = 'Positive') AND gender = 'Male' AND age BETWEEN 50 AND 59 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS sd_biolinem9,
                (SELECT count(lab_info_id) FROM v_w_haematology_labs WHERE (sd_bioline = 'Positive' OR hiv_final = 'Positive') AND gender = 'Male' AND age BETWEEN 60 AND 69 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS sd_biolinem10,
                (SELECT count(lab_info_id) FROM v_w_haematology_labs WHERE (sd_bioline = 'Positive' OR hiv_final = 'Positive') AND gender = 'Male' AND age > 69 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS sd_biolinem11,
                (SELECT count(lab_info_id) FROM v_w_haematology_labs WHERE (sd_bioline = 'Positive' OR hiv_final = 'Positive') AND gender = 'Male' AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS sd_biolinem12,
                (SELECT count(lab_info_id) FROM v_w_haematology_labs WHERE (sd_bioline = 'Positive' OR hiv_final = 'Positive') AND gender = 'Female' AND age < 1 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS sd_biolinef1,
                (SELECT count(lab_info_id) FROM v_w_haematology_labs WHERE (sd_bioline = 'Positive' OR hiv_final = 'Positive') AND gender = 'Female' AND age BETWEEN 1 AND 4 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS sd_biolinef2,
                (SELECT count(lab_info_id) FROM v_w_haematology_labs WHERE (sd_bioline = 'Positive' OR hiv_final = 'Positive') AND gender = 'Female' AND age BETWEEN 5 AND 9 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS sd_biolinef3,
                (SELECT count(lab_info_id) FROM v_w_haematology_labs WHERE (sd_bioline = 'Positive' OR hiv_final = 'Positive') AND gender = 'Female' AND age BETWEEN 10 AND 14 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS sd_biolinef4,
                (SELECT count(lab_info_id) FROM v_w_haematology_labs WHERE (sd_bioline = 'Positive' OR hiv_final = 'Positive') AND gender = 'Female' AND age BETWEEN 15 AND 17 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS sd_biolinef5,
                (SELECT count(lab_info_id) FROM v_w_haematology_labs WHERE (sd_bioline = 'Positive' OR hiv_final = 'Positive') AND gender = 'Female' AND age BETWEEN 18 AND 19 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS sd_biolinef6,
                (SELECT count(lab_info_id) FROM v_w_haematology_labs WHERE (sd_bioline = 'Positive' OR hiv_final = 'Positive') AND gender = 'Female' AND age BETWEEN 20 AND 34 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS sd_biolinef7,
                (SELECT count(lab_info_id) FROM v_w_haematology_labs WHERE (sd_bioline = 'Positive' OR hiv_final = 'Positive') AND gender = 'Female' AND age BETWEEN 35 AND 49 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS sd_biolinef8,
                (SELECT count(lab_info_id) FROM v_w_haematology_labs WHERE (sd_bioline = 'Positive' OR hiv_final = 'Positive') AND gender = 'Female' AND age BETWEEN 50 AND 59 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS sd_biolinef9,
                (SELECT count(lab_info_id) FROM v_w_haematology_labs WHERE (sd_bioline = 'Positive' OR hiv_final = 'Positive') AND gender = 'Female' AND age BETWEEN 60 AND 69 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS sd_biolinef10,
                (SELECT count(lab_info_id) FROM v_w_haematology_labs WHERE (sd_bioline = 'Positive' OR hiv_final = 'Positive') AND gender = 'Female' AND age > 69 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS sd_biolinef11,
                (SELECT count(lab_info_id) FROM v_w_haematology_labs WHERE (sd_bioline = 'Positive' OR hiv_final = 'Positive') AND gender = 'Female' AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS sd_biolinef12,
                (SELECT count(lab_info_id) FROM v_w_haematology_labs WHERE (sd_bioline = 'Positive' OR hiv_final = 'Positive') AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS sd_bioline
            ");

        $coombs = DB::select("SELECT 
                (SELECT count(indirect) FROM v_w_haematology_labs WHERE (indirect IS NOT NULL OR direct IS NOT NULL) AND gender = 'Male' AND age < 1 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS indirectm1,
                (SELECT count(indirect) FROM v_w_haematology_labs WHERE (indirect IS NOT NULL OR direct IS NOT NULL) AND gender = 'Male' AND age BETWEEN 1 AND 4 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS indirectm2,
                (SELECT count(indirect) FROM v_w_haematology_labs WHERE (indirect IS NOT NULL OR direct IS NOT NULL) AND gender = 'Male' AND age BETWEEN 5 AND 9 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS indirectm3,
                (SELECT count(indirect) FROM v_w_haematology_labs WHERE (indirect IS NOT NULL OR direct IS NOT NULL) AND gender = 'Male' AND age BETWEEN 10 AND 14 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS indirectm4,
                (SELECT count(indirect) FROM v_w_haematology_labs WHERE (indirect IS NOT NULL OR direct IS NOT NULL) AND gender = 'Male' AND age BETWEEN 15 AND 17 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS indirectm5,
                (SELECT count(indirect) FROM v_w_haematology_labs WHERE (indirect IS NOT NULL OR direct IS NOT NULL) AND gender = 'Male' AND age BETWEEN 18 AND 19 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS indirectm6,
                (SELECT count(indirect) FROM v_w_haematology_labs WHERE (indirect IS NOT NULL OR direct IS NOT NULL) AND gender = 'Male' AND age BETWEEN 20 AND 34 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS indirectm7,
                (SELECT count(indirect) FROM v_w_haematology_labs WHERE (indirect IS NOT NULL OR direct IS NOT NULL) AND gender = 'Male' AND age BETWEEN 35 AND 49 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS indirectm8,
                (SELECT count(indirect) FROM v_w_haematology_labs WHERE (indirect IS NOT NULL OR direct IS NOT NULL) AND gender = 'Male' AND age BETWEEN 50 AND 59 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS indirectm9,
                (SELECT count(indirect) FROM v_w_haematology_labs WHERE (indirect IS NOT NULL OR direct IS NOT NULL) AND gender = 'Male' AND age BETWEEN 60 AND 69 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS indirectm10,
                (SELECT count(indirect) FROM v_w_haematology_labs WHERE (indirect IS NOT NULL OR direct IS NOT NULL) AND gender = 'Male' AND age > 69 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS indirectm11,
                (SELECT count(indirect) FROM v_w_haematology_labs WHERE (indirect IS NOT NULL OR direct IS NOT NULL) AND gender = 'Male' AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS indirectm12,
                (SELECT count(indirect) FROM v_w_haematology_labs WHERE (indirect IS NOT NULL OR direct IS NOT NULL) AND gender = 'Female' AND age < 1 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS indirectf1,
                (SELECT count(indirect) FROM v_w_haematology_labs WHERE (indirect IS NOT NULL OR direct IS NOT NULL) AND gender = 'Female' AND age BETWEEN 1 AND 4 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS indirectf2,
                (SELECT count(indirect) FROM v_w_haematology_labs WHERE (indirect IS NOT NULL OR direct IS NOT NULL) AND gender = 'Female' AND age BETWEEN 5 AND 9 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS indirectf3,
                (SELECT count(indirect) FROM v_w_haematology_labs WHERE (indirect IS NOT NULL OR direct IS NOT NULL) AND gender = 'Female' AND age BETWEEN 10 AND 14 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS indirectf4,
                (SELECT count(indirect) FROM v_w_haematology_labs WHERE (indirect IS NOT NULL OR direct IS NOT NULL) AND gender = 'Female' AND age BETWEEN 15 AND 17 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS indirectf5,
                (SELECT count(indirect) FROM v_w_haematology_labs WHERE (indirect IS NOT NULL OR direct IS NOT NULL) AND gender = 'Female' AND age BETWEEN 18 AND 19 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS indirectf6,
                (SELECT count(indirect) FROM v_w_haematology_labs WHERE (indirect IS NOT NULL OR direct IS NOT NULL) AND gender = 'Female' AND age BETWEEN 20 AND 34 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS indirectf7,
                (SELECT count(indirect) FROM v_w_haematology_labs WHERE (indirect IS NOT NULL OR direct IS NOT NULL) AND gender = 'Female' AND age BETWEEN 35 AND 49 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS indirectf8,
                (SELECT count(indirect) FROM v_w_haematology_labs WHERE (indirect IS NOT NULL OR direct IS NOT NULL) AND gender = 'Female' AND age BETWEEN 50 AND 59 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS indirectf9,
                (SELECT count(indirect) FROM v_w_haematology_labs WHERE (indirect IS NOT NULL OR direct IS NOT NULL) AND gender = 'Female' AND age BETWEEN 60 AND 69 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS indirectf10,
                (SELECT count(indirect) FROM v_w_haematology_labs WHERE (indirect IS NOT NULL OR direct IS NOT NULL) AND gender = 'Female' AND age > 69 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS indirectf11,
                (SELECT count(indirect) FROM v_w_haematology_labs WHERE (indirect IS NOT NULL OR direct IS NOT NULL) AND gender = 'Female' AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS indirectf12,
                (SELECT count(indirect) FROM v_w_haematology_labs WHERE (indirect IS NOT NULL OR direct IS NOT NULL) AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS indirect
            ");

        $covid = DB::select("SELECT 
                (SELECT count(lab_info_id) FROM v_w_haematology_labs WHERE covid = 'Positive' AND gender = 'Male' AND age < 1 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS covidm1,
                (SELECT count(lab_info_id) FROM v_w_haematology_labs WHERE covid = 'Positive' AND gender = 'Male' AND age BETWEEN 1 AND 4 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS covidm2,
                (SELECT count(lab_info_id) FROM v_w_haematology_labs WHERE covid = 'Positive' AND gender = 'Male' AND age BETWEEN 5 AND 9 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS covidm3,
                (SELECT count(lab_info_id) FROM v_w_haematology_labs WHERE covid = 'Positive' AND gender = 'Male' AND age BETWEEN 10 AND 14 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS covidm4,
                (SELECT count(lab_info_id) FROM v_w_haematology_labs WHERE covid = 'Positive' AND gender = 'Male' AND age BETWEEN 15 AND 17 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS covidm5,
                (SELECT count(lab_info_id) FROM v_w_haematology_labs WHERE covid = 'Positive' AND gender = 'Male' AND age BETWEEN 18 AND 19 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS covidm6,
                (SELECT count(lab_info_id) FROM v_w_haematology_labs WHERE covid = 'Positive' AND gender = 'Male' AND age BETWEEN 20 AND 34 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS covidm7,
                (SELECT count(lab_info_id) FROM v_w_haematology_labs WHERE covid = 'Positive' AND gender = 'Male' AND age BETWEEN 35 AND 49 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS covidm8,
                (SELECT count(lab_info_id) FROM v_w_haematology_labs WHERE covid = 'Positive' AND gender = 'Male' AND age BETWEEN 50 AND 59 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS covidm9,
                (SELECT count(lab_info_id) FROM v_w_haematology_labs WHERE covid = 'Positive' AND gender = 'Male' AND age BETWEEN 60 AND 69 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS covidm10,
                (SELECT count(lab_info_id) FROM v_w_haematology_labs WHERE covid = 'Positive' AND gender = 'Male' AND age > 69 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS covidm11,
                (SELECT count(lab_info_id) FROM v_w_haematology_labs WHERE covid = 'Positive' AND gender = 'Male' AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS covidm12,
                (SELECT count(lab_info_id) FROM v_w_haematology_labs WHERE covid = 'Positive' AND gender = 'Female' AND age < 1 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS covidf1,
                (SELECT count(lab_info_id) FROM v_w_haematology_labs WHERE covid = 'Positive' AND gender = 'Female' AND age BETWEEN 1 AND 4 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS covidf2,
                (SELECT count(lab_info_id) FROM v_w_haematology_labs WHERE covid = 'Positive' AND gender = 'Female' AND age BETWEEN 5 AND 9 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS covidf3,
                (SELECT count(lab_info_id) FROM v_w_haematology_labs WHERE covid = 'Positive' AND gender = 'Female' AND age BETWEEN 10 AND 14 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS covidf4,
                (SELECT count(lab_info_id) FROM v_w_haematology_labs WHERE covid = 'Positive' AND gender = 'Female' AND age BETWEEN 15 AND 17 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS covidf5,
                (SELECT count(lab_info_id) FROM v_w_haematology_labs WHERE covid = 'Positive' AND gender = 'Female' AND age BETWEEN 18 AND 19 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS covidf6,
                (SELECT count(lab_info_id) FROM v_w_haematology_labs WHERE covid = 'Positive' AND gender = 'Female' AND age BETWEEN 20 AND 34 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS covidf7,
                (SELECT count(lab_info_id) FROM v_w_haematology_labs WHERE covid = 'Positive' AND gender = 'Female' AND age BETWEEN 35 AND 49 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS covidf8,
                (SELECT count(lab_info_id) FROM v_w_haematology_labs WHERE covid = 'Positive' AND gender = 'Female' AND age BETWEEN 50 AND 59 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS covidf9,
                (SELECT count(lab_info_id) FROM v_w_haematology_labs WHERE covid = 'Positive' AND gender = 'Female' AND age BETWEEN 60 AND 69 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS covidf10,
                (SELECT count(lab_info_id) FROM v_w_haematology_labs WHERE covid = 'Positive' AND gender = 'Female' AND age > 69 AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS covidf11,
                (SELECT count(lab_info_id) FROM v_w_haematology_labs WHERE covid = 'Positive' AND gender = 'Female' AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS covidf12,
                (SELECT count(lab_info_id) FROM v_w_haematology_labs WHERE covid = 'Positive' AND CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at )) ='$year_month') AS covid
            ");

        //$anti_tpha = VWHaematologyLab::whereNotNull('anti_tpha')->where(DB::raw("CONCAT(EXTRACT(YEAR FROM updated_at ),EXTRACT(MONTH FROM updated_at ))"), "$year_month")->count();
        
        return [
                'anti_tpha' => $anti_tpha[0],
                'anti_tpha_pos' => $anti_tpha_pos[0],
                'hcv' => $hcv[0],
                'hcv_pos' => $hcv_pos[0],
                'hbsag' => $hbsag[0],
                'hbsag_pos' => $hbsag_pos[0],
                'fbs' => $fbs[0],
                'blood' => $blood[0],
                'g6pd_nor' => $g6pd_nor[0],
                'g6pd_par' => $g6pd_par[0],
                'g6pd_ful' => $g6pd_ful[0],
                'urine_hcg' => $urine_hcg[0],
                'bf_pos' => $bf_pos[0],
                'bf_neg' => $bf_neg[0],
                'bf_neg_anc' => $bf_neg_anc[0],
                'bf_pos_anc' => $bf_pos_anc[0],
                'bf_neg_opd' => $bf_neg_opd[0],
                'bf_pos_opd' => $bf_pos_opd[0],
                'bf_neg_ipd' => $bf_neg_ipd[0],
                'bf_pos_ipd' => $bf_pos_ipd[0],
                'rdt_pf_pos' => $rdt_pf_pos[0],
                'rdt_pf_neg' => $rdt_pf_neg[0],
                'esr' => $esr[0],
                'sickling_pos' => $sickling_pos[0],
                'sickling_neg' => $sickling_neg[0],
                'sickling_hb' => $sickling_hb[0],
                'widal_o' => $widal_o[0],
                'widal_h' => $widal_h[0],
                'urinalysis' => $urinalysis[0],
                'stool' => $stool[0],
                'fbc' => $fbc[0],
                'hiv' => $hiv[0],
                'hiv_pos' => $hiv_pos[0],
                'coombs' => $coombs[0],
                'covid' => $covid[0]
            ];
    }
}
